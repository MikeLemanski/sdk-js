!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("tweetnacl"),require("fast-sha256"),require("base64url"),require("json-stable-stringify"),require("axios"),require("es6-promise")):"function"==typeof define&&define.amd?define("token-io.node",["tweetnacl","fast-sha256","base64url","json-stable-stringify","axios","es6-promise"],t):"object"==typeof exports?exports["token-io.node"]=t(require("tweetnacl"),require("fast-sha256"),require("base64url"),require("json-stable-stringify"),require("axios"),require("es6-promise")):e["token-io.node"]=t(e.tweetnacl,e["fast-sha256"],e.base64url,e["json-stable-stringify"],e.axios,e["es6-promise"])}(this,function(e,t,n,r,a,u){return function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={exports:{},id:r,loaded:!1};return e[r].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),o=r(i),s=n(6),c=r(s),f=n(10),l=r(f),d=n(17),h=r(d),y=n(11),v=r(y),k=n(27),_=r(k),m=n(23),g=r(m),p=n(28),b=r(p);n(29).polyfill();var T=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"prd";a(this,e),this._env=t,this._unauthenticatedClient=new _["default"](t),this.Crypto=o["default"],this.Util=c["default"],this.KeyLevel=h["default"],this.TokenOperationResult=g["default"]}return u(e,[{key:"usernameExists",value:function(e){var t=this;return this._unauthenticatedClient.usernameExists(e).then(function(e){return!!e.data.exists&&e.data.exists})["catch"](function(e){return c["default"].reject(t.usernameExists,e)})}},{key:"createMember",value:function(e){var t=this,n=o["default"].generateKeys();return this._unauthenticatedClient.createMemberId().then(function(r){return t._unauthenticatedClient.addFirstKey(n,r.data.memberId).then(function(){var a=new l["default"](t._env,r.data.memberId,n);return a.addUsername(e).then(function(){return a})})})["catch"](function(e){return c["default"].reject(t.createMember,e)})}},{key:"login",value:function(e,t){var n=this;return Promise.resolve(new l["default"](this._env,e,t))["catch"](function(e){return c["default"].reject(n.login,e)})}},{key:"loginWithUsername",value:function(e,t){var n=this;return new b["default"](this._env,t,e).getMemberByUsername().then(function(t){return new l["default"](n._env,t.data.member.id,e)})["catch"](function(e){return c["default"].reject(n.loginWithUsername,e)})}},{key:"loginFromLocalStorage",value:function(){try{var e=v["default"].loadMember(this._env);return Promise.resolve(e)}catch(t){return c["default"].reject(this.loginFromLocalStorage,t)}}},{key:"notifyLinkAccounts",value:function(e,t,n,r){var a=this,u={linkAccounts:{bankId:t,bankName:n,accountLinkPayloads:r}};return this._unauthenticatedClient.notify(e,u)["catch"](function(e){return c["default"].reject(a.notifyLinkAccounts,e)})}},{key:"notifyAddKey",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a={addKey:{publicKey:o["default"].strKey(t),name:r}};return this._unauthenticatedClient.notify(e,a)["catch"](function(e){return c["default"].reject(n.notifyAddKey,e)})}},{key:"notifyLinkAccountsAndAddKey",value:function(e,t,n,r,a){var u=this,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",s={linkAccountsAndAddKey:{linkAccounts:{bankId:t,bankName:n,accountLinkPayloads:r},addKey:{publicKey:o["default"].strKey(a),name:i}}};return this._unauthenticatedClient.notify(e,s)["catch"](function(e){return c["default"].reject(u.notifyLinkAccountsAndAddKey,e)})}}]),e}();e.exports=T},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),o=r(i),s=n(3),c=r(s),f=n(4),l=r(f),d=n(5),h=r(d),y=function(){function e(){a(this,e)}return u(e,null,[{key:"generateKeys",value:function(){var e=o["default"].sign.keyPair();return e.keyId=(0,l["default"])((0,c["default"])(e.publicKey)).substring(0,16),e}},{key:"signJson",value:function(t,n){return e.sign((0,h["default"])(t),n)}},{key:"sign",value:function(e,t){var n=new Buffer(e);return(0,l["default"])(o["default"].sign.detached(n,t.secretKey))}},{key:"strKey",value:function(e){return(0,l["default"])(e)}},{key:"bufferKey",value:function(e){return l["default"].toBuffer(e)}}]),e}();t["default"]=y},function(e,t){e.exports=require("tweetnacl")},function(e,t){e.exports=require("fast-sha256")},function(e,t){e.exports=require("base64url")},function(e,t){e.exports=require("json-stable-stringify")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),o=r(i),s=n(7),c=r(s),f=function(){function e(){a(this,e)}return u(e,null,[{key:"generateNonce",value:function(){return(0,c["default"])(o["default"].sign.keyPair().publicKey)}},{key:"reject",value:function(e,t){return Promise.reject({type:e.name,error:t,reason:void 0!==t.response&&void 0!==t.response.data?t.response.data:"UNKNOWN"})}}]),e}();t["default"]=f},function(e,t,n){e.exports=n(8)["default"],e.exports["default"]=e.exports},function(e,t,n){"use strict";function r(e,t){return void 0===t&&(t="utf8"),i(Buffer.isBuffer(e)?e.toString("base64"):new Buffer(e,t).toString("base64"))}function a(e,t){return void 0===t&&(t="utf8"),new Buffer(u(e),"base64").toString(t)}function u(e){return e=e.toString(),s["default"](e).replace(/\-/g,"+").replace(/_/g,"/")}function i(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function o(e){return new Buffer(u(e),"base64")}var s=n(9),c=r;c.encode=r,c.decode=a,c.toBase64=u,c.fromBase64=i,c.toBuffer=o,Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=c},function(e,t){"use strict";function n(e){var t=4,n=e.length,r=n%t;if(!r)return e;var a=n,u=t-r,i=n+u,o=new Buffer(i);for(o.write(e);u--;)o.write("=",a++);return o.toString()}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),o=r(i),s=n(11),c=r(s),f=n(12),l=r(f),d=n(15),h=r(d),y=n(16),v=r(y),k=n(17),_=r(k),m=n(18),g=r(m),p=n(13),b=r(p),T=n(23),w=r(T),A=n(24),j=r(A),I=n(25),S=r(I),O=n(26),P=r(O),M=n(6),E=r(M),K=function(){function e(t,n,r){a(this,e),this._id=n,this._keys=r,this._client=new g["default"](t,n,r)}return u(e,[{key:"saveToLocalStorage",value:function(){c["default"].saveMember(this)}},{key:"useAccessToken",value:function(e){this._client.useAccessToken(e)}},{key:"clearAccessToken",value:function(){this._client.clearAccessToken()}},{key:"approveKey",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_["default"].PRIVILEGED;return this._getPreviousHash().then(function(r){return t._client.addKey(r,o["default"].bufferKey(e),n).then(function(e){})})["catch"](function(e){return E["default"].reject(t.approveKey,e)})}},{key:"removeKey",value:function(e){var t=this;return this._getPreviousHash().then(function(n){return t._client.removeKey(n,e).then(function(e){})})["catch"](function(e){return E["default"].reject(t.removeKey,e)})}},{key:"addUsername",value:function(e){var t=this;return this._getPreviousHash().then(function(n){return t._client.addUsername(n,e).then(function(e){})})["catch"](function(e){return E["default"].reject(t.addUsername,e)})}},{key:"removeUsername",value:function(e){var t=this;return this._getPreviousHash().then(function(n){return t._client.removeUsername(n,e).then(function(e){})})["catch"](function(e){return E["default"].reject(t.removeUsername,e)})}},{key:"linkAccounts",value:function(e,t){var n=this;return this._client.linkAccounts(e,t).then(function(e){return e.data.accounts.map(function(e){return new l["default"](n,e)})})["catch"](function(e){return E["default"].reject(n.linkAccounts,e)})}},{key:"getAccounts",value:function(){var e=this;return this._client.getAccounts().then(function(t){return t.data.accounts.map(function(t){return new l["default"](e,t)})})["catch"](function(t){return E["default"].reject(e.getAccounts,t)})}},{key:"subscribeToNotifications",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"IOS";return this._client.subscribeToNotifications(e,n).then(function(e){return new h["default"](e.data.subscriber)})["catch"](function(e){return E["default"].reject(t.subscribeToNotifications,e)})}},{key:"getSubscribers",value:function(){var e=this;return this._client.getSubscribers().then(function(e){return e.data.subscribers.map(function(e){return new h["default"](e)})})["catch"](function(t){return E["default"].reject(e.getSubscribers,t)})}},{key:"getSubscriber",value:function(e){var t=this;return this._client.getSubscriber(e).then(function(e){return new h["default"](e.data.subscriber)})["catch"](function(e){return E["default"].reject(t.getSubscriber,e)})}},{key:"unsubscribeFromNotifications",value:function(e){var t=this;return this._client.unsubscribeFromNotifications(e)["catch"](function(e){return E["default"].reject(t.unsubscribeFromNotifications,e)})}},{key:"addAddress",value:function(e,t){var n=this;return this._client.addAddress(e,t).then(function(e){return new v["default"](e.data.address)})["catch"](function(e){return E["default"].reject(n.addAddress,e)})}},{key:"getAddress",value:function(e){var t=this;return this._client.getAddress(e).then(function(e){return new v["default"](e.data.address)})["catch"](function(e){return E["default"].reject(t.getAddress,e)})}},{key:"getAddresses",value:function(){var e=this;return this._client.getAddresses().then(function(e){return e.data.addresses.map(function(e){return new v["default"](e)})})["catch"](function(t){return E["default"].reject(e.getAddresses,t)})}},{key:"getAllUsernames",value:function(){var e=this;return this._getMember().then(function(e){return e.usernames})["catch"](function(t){return E["default"].reject(e.getAllUsernames,t)})}},{key:"createAccessToken",value:function(e,t){var n=this,r=new S["default"]((void 0),this,e,t);return this._client.createToken(r.json).then(function(e){return S["default"].createFromToken(e.data.token)})["catch"](function(e){return E["default"].reject(n.createAccessToken,e)})}},{key:"createAddressesAccessToken",value:function(e){var t=this,n=S["default"].addressesAccessToken(this,e);return this._client.createToken(n.json).then(function(e){return S["default"].createFromToken(e.data.token)})["catch"](function(e){return E["default"].reject(t.createAddressesAccessToken,e)})}},{key:"createAddressAccessToken",value:function(e,t){var n=this,r=S["default"].addressAccessToken(this,e,t);return this._client.createToken(r.json).then(function(e){return S["default"].createFromToken(e.data.token)})["catch"](function(e){return E["default"].reject(n.createAddressAccessTokenn,e)})}},{key:"createAccountsAccessToken",value:function(e){var t=this,n=S["default"].accountsAccessToken(this,e);return this._client.createToken(n.json).then(function(e){return S["default"].createFromToken(e.data.token)})["catch"](function(e){return E["default"].reject(t.createAccountsAccessToken,e)})}},{key:"createAccountAccessToken",value:function(e,t){var n=this,r=S["default"].accountAccessToken(this,e,t);return this._client.createToken(r.json).then(function(e){return S["default"].createFromToken(e.data.token)})["catch"](function(e){return E["default"].reject(n.createAccountAccessToken,e)})}},{key:"createAccountsTransactionsAccessToken",value:function(e){var t=this,n=S["default"].accountsTransactionsAccessToken(this,e);return this._client.createToken(n.json).then(function(e){return S["default"].createFromToken(e.data.token)})["catch"](function(e){return E["default"].reject(t.createAccountsTransactionsAccessToken,e)})}},{key:"createAccountTransactionsAccessToken",value:function(e,t){var n=this,r=S["default"].accountTransactionsAccessToken(this,e,t);return this._client.createToken(r.json).then(function(e){return S["default"].createFromToken(e.data.token)})["catch"](function(e){return E["default"].reject(n.createAccountTransactionsAccessToken,e)})}},{key:"createBalancesAccessToken",value:function(e){var t=this,n=S["default"].balancesAccessToken(this,e);return this._client.createToken(n.json).then(function(e){return S["default"].createFromToken(e.data.token)})["catch"](function(e){return E["default"].reject(t.balancesAccessToken,e)})}},{key:"createBalanceAccessToken",value:function(e,t){var n=this,r=S["default"].balanceAccessToken(this,e,t);return this._client.createToken(r.json).then(function(e){return S["default"].createFromToken(e.data.token)})["catch"](function(e){return E["default"].reject(n.createBalanceAccessToken,e)})}},{key:"createToken",value:function(e,t,n,r){var a=this,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,i=j["default"].create(this,e,t,n,r,u);return this._client.createToken(i.json).then(function(e){return j["default"].createFromToken(e.data.token)})["catch"](function(e){return E["default"].reject(a.createToken,e)})}},{key:"getToken",value:function(e){var t=this;return this._client.getToken(e).then(function(e){return void 0!==e.data.token.payload.access?S["default"].createFromToken(e.data.token):j["default"].createFromToken(e.data.token)})["catch"](function(e){return E["default"].reject(t.getToken,e)})}},{key:"getTransferTokens",value:function(e,t){var n=this;return this._client.getTokens("TRANSFER",e,t).then(function(e){return new b["default"](void 0===e.data.tokens?[]:e.data.tokens.map(function(e){return j["default"].createFromToken(e)}),e.data.offset)})["catch"](function(e){return E["default"].reject(n.getTransferTokens,e)})}},{key:"getAccessTokens",value:function(e,t){var n=this;return this._client.getTokens("ACCESS",e,t).then(function(e){return new b["default"](void 0===e.data.tokens?[]:e.data.tokens.map(function(e){return S["default"].createFromToken(e)}),e.data.offset)})["catch"](function(e){return E["default"].reject(n.getAccessTokens,e)})}},{key:"endorseToken",value:function(e){var t=this;return this._resolveToken(e).then(function(n){return t._client.endorseToken(n).then(function(t){return"string"==typeof e||e instanceof String||(e.payloadSignatures=t.data.result.token.payloadSignatures),new w["default"](t.data.result,e)})})["catch"](function(e){return E["default"].reject(t.endorseToken,e)})}},{key:"cancelToken",value:function(e){var t=this;return this._resolveToken(e).then(function(n){return t._client.cancelToken(n).then(function(t){return"string"==typeof e||e instanceof String||(e.payloadSignatures=t.data.result.token.payloadSignatures),new w["default"](t.data.result,e)})})["catch"](function(e){return E["default"].reject(t.cancelToken,e)})}},{key:"createTransfer",value:function(e,t,n){var r=this;return this._resolveToken(e).then(function(e){return void 0===t&&(t=e.payload.transfer.amount),void 0===n&&(n=e.payload.transfer.currency),r._client.createTransfer(e,t,n).then(function(e){return new P["default"](e.data.transfer)})})["catch"](function(e){return E["default"].reject(r.createTransfer,e)})}},{key:"getTransfer",value:function(e){var t=this;return this._client.getTransfer(e).then(function(e){return new P["default"](e.data.transfer)})["catch"](function(e){return E["default"].reject(t.getTransfer,e)})}},{key:"getTransfers",value:function(e,t,n){var r=this;return this._client.getTransfers(e,t,n).then(function(e){return new b["default"](e.data.transfers.map(function(e){return new P["default"](e)}),e.data.offset)})["catch"](function(e){return E["default"].reject(r.getTransfers,e)})}},{key:"getPublicKeys",value:function(){var e=this;return this._getMember().then(function(e){return e.keys})["catch"](function(t){return E["default"].reject(e.getPublicKeys,t)})}},{key:"_getPreviousHash",value:function(){var e=this;return this._getMember().then(function(e){return e.lastHash})["catch"](function(t){return E["default"].reject(e._getPreviousHash,t)})}},{key:"_getMember",value:function(){var e=this;return this._client.getMember().then(function(e){return e.data.member})["catch"](function(t){return E["default"].reject(e._getMember,t)})}},{key:"_resolveToken",value:function(e){var t=this;return new Promise(function(n,r){"string"==typeof e||e instanceof String?t.getToken(e).then(function(e){return n(e)}):n(e)})}},{key:"id",get:function(){return this._id}},{key:"keys",get:function(){return this._keys}}]),e}();t["default"]=K},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(10),o=(r(i),n(1)),s=(r(o),function(){function e(){a(this,e)}return u(e,null,[{key:"saveMember",value:function(e){throw new Error("Browser Only")}},{key:"loadMember",value:function(e){throw new Error("Browser Only")}}]),e}());t["default"]=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(13),o=r(i),s=n(14),c=r(s),f=n(6),l=r(f),d=function(){function e(t,n){a(this,e),this._member=t,this._id=n.id,this._name=n.name}return u(e,[{key:"getBalance",value:function(){var e=this;return this._member._client.getBalance(this._id).then(function(e){return e.data})["catch"](function(t){return l["default"].reject(e.getBalance,t)})}},{key:"getTransaction",value:function(e){var t=this;return this._member._client.getTransaction(this._id,e).then(function(e){return new c["default"](e.data.transaction)})["catch"](function(e){return l["default"].reject(t.getTransaction,e)})}},{key:"getTransactions",value:function(e,t){var n=this;return this._member._client.getTransactions(this._id,e,t).then(function(e){return new o["default"](e.data.transactions.map(function(e){return new c["default"](e)}),e.data.offset)})["catch"](function(e){return l["default"].reject(n.getTransactions,e)})}},{key:"member",get:function(){return this._member}},{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}}]),e}();t["default"]=d},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t,r){n(this,e),this._data=t,this._offset=r}return r(e,[{key:"data",get:function(){return this._data}},{key:"offset",get:function(){return this._offset}}]),e}();t["default"]=a},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){n(this,e),this._id=t.id,this._type=t.type,this._currency=t.amount.currency,this._amount=parseFloat(t.amount.value),this._description=t.description,this._tokenId=t.tokenId,this._tokenTransferId=t.tokenTransferId}return r(e,[{key:"id",get:function(){return this._id}},{key:"type",get:function(){return this._type}},{key:"amount",get:function(){return this._amount}},{key:"currency",get:function(){return this._currency}},{key:"description",get:function(){return this._description}},{key:"tokenId",get:function(){return this._tokenId}},{key:"tokenTransferId",get:function(){return this._tokenTransferId}}]),e}();t["default"]=a},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){n(this,e),this._id=t.id,this._target=t.target,this._platform=t.platform}return r(e,[{key:"id",get:function(){return this._id}},{key:"target",get:function(){return this._target}},{key:"platform",get:function(){return this._platform}}]),e}();t["default"]=a},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){n(this,e),this._id=t.id,this._name=t.name,this._address=t.address,this._addressSignature=t.addressSignature}return r(e,[{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}},{key:"address",get:function(){return this._address}},{key:"addressSignature",get:function(){return this._addressSignature}}]),e}();t["default"]=a},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={PRIVILEGED:"PRIVILEGED",STANDARD:"STANDARD",LOW:"LOW"}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),o=r(i),s=n(6),c=r(s),f=n(19),l=r(f),d=n(21),h=r(d),y=n(20),v=n(17),k=r(v),_=n(5),m=n(22),g=function(){function e(t,n,r){a(this,e),this._instance=m.create({baseURL:y.urls[t]}),this._memberId=n,this._keys=r,this._context=new h["default"],this._authHeader=new l["default"](y.urls[t],r),this._resetInterceptor()}return u(e,[{key:"_resetInterceptor",value:function(){var e=this;this._instance.interceptors.request.eject(this._interceptor),this._interceptor=this._instance.interceptors.request.use(function(t){return e._authHeader.addAuthorizationHeaderMemberId(e._memberId,t,e._context),t})}},{key:"useAccessToken",value:function(e){this._context.onBehalfOf=e,this._resetInterceptor()}},{key:"clearAccessToken",value:function(){this._context.onBehalfOf=void 0,this._resetInterceptor()}},{key:"subscribeToNotifications",value:function(e,t){var n={target:e,platform:t},r={method:"post",url:"/subscribers",data:n};return this._instance(r)}},{key:"getSubscribers",value:function(){var e={method:"get",url:"/subscribers"};return this._instance(e)}},{key:"getSubscriber",value:function(e){var t={method:"get",url:"/subscribers/"+e};return this._instance(t)}},{key:"unsubscribeFromNotifications",value:function(e){var t={method:"delete",url:"/subscribers/"+e};return this._instance(t)}},{key:"addAddress",value:function(e,t){var n={name:e,address:t,addressSignature:{memberId:this._memberId,keyId:this._keys.keyId,signature:o["default"].signJson(t,this._keys)}},r={method:"post",url:"/addresses",data:n};return this._instance(r)}},{key:"getAddress",value:function(e){var t={method:"get",url:"/addresses/"+e};return this._instance(t)}},{key:"getAddresses",value:function(){var e={method:"get",url:"/addresses"};return this._instance(e)}},{key:"linkAccounts",value:function(e,t){var n={bankId:e,accountLinkPayloads:t},r={method:"post",url:"/accounts",data:n};return this._instance(r)}},{key:"getAccounts",value:function(){var e={method:"get",url:"/accounts"};return this._instance(e)}},{key:"setAccountName",value:function(e,t){var n={method:"patch",url:"/accounts/"+e+"?name="+t};return this._instance(n)}},{key:"getBalance",value:function(e){var t={method:"get",url:"/accounts/"+e+"/balance"};return this._instance(t)}},{key:"getTransaction",value:function(e,t){var n={method:"get",url:"/accounts/"+e+"/transactions/"+t};return this._instance(n)}},{key:"getTransactions",value:function(e,t,n){var r={method:"get",url:"/accounts/"+e+"/transactions?offset="+t+"&limit="+n};return this._instance(r)}},{key:"createToken",value:function(e){var t={method:"post",url:"/tokens",data:{payload:e}};return this._instance(t)}},{key:"endorseToken",value:function(e){return this._tokenOperation(e,"endorse","endorsed")}},{key:"cancelToken",value:function(e){return this._tokenOperation(e,"cancel","cancelled")}},{key:"_tokenOperation",value:function(e,t,n){var r=_(e.json)+("."+n),a={tokenId:e.id,signature:{memberId:this._memberId,keyId:this._keys.keyId,signature:o["default"].sign(r,this._keys)}},u=e.id,i={method:"put",url:"/tokens/"+u+"/"+t,data:a};return this._instance(i)}},{key:"createTransfer",value:function(e,t,n){var r={nonce:c["default"].generateNonce(),tokenId:e.id,amount:{value:t.toString(),currency:n},transfer:e.transfer},a={payload:r,payloadSignature:{memberId:this._memberId,keyId:this._keys.keyId,signature:o["default"].signJson(r,this._keys)}},u={method:"post",url:"/transfers",data:a};return this._instance(u)}},{key:"getToken",value:function(e){var t={method:"get",url:"/tokens/"+e};return this._instance(t)}},{key:"getTokens",value:function(e,t,n){var r={method:"get",url:"/tokens?type="+e+"&offset="+t+"&limit="+n};return this._instance(r)}},{key:"getTransfer",value:function(e){var t={method:"get",url:"/transfers/"+e};return this._instance(t)}},{key:"getTransfers",value:function(e,t,n){var r={method:"get",url:"/transfers?tokenId="+e+"&offset="+t+"&limit="+n};return this._instance(r)}},{key:"getMember",value:function(){var e={method:"get",url:"/members"};return this._instance(e)}},{key:"addKey",value:function(e,t,n){var r={memberId:this._memberId,addKey:{publicKey:o["default"].strKey(t)}};return n!==k["default"].PRIVILEGED&&(r.addKey.level=n),this._memberUpdate(r,e)}},{key:"removeKey",value:function(e,t){var n={memberId:this._memberId,removeKey:{keyId:t}};return this._memberUpdate(n,e)}},{key:"addUsername",value:function(e,t){var n={memberId:this._memberId,addUsername:{username:t}};return this._memberUpdate(n,e)}},{key:"removeUsername",value:function(e,t){var n={memberId:this._memberId,removeUsername:{username:t}};return this._memberUpdate(n,e)}},{key:"_memberUpdate",value:function(e,t){""!==t&&(e.prevHash=t);var n={update:e,updateSignature:{memberId:this._memberId,keyId:this._keys.keyId,signature:o["default"].signJson(e,this._keys)}},r={method:"post",url:"/members/"+this._memberId+"/updates",data:n};return this._instance(r)}}]),e}();t["default"]=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(20),o=n(1),s=r(o),c=n(5),f=function(){function e(t,n){a(this,e),this._baseUrl=t,this._keys=n}return u(e,[{key:"addAuthorizationHeaderMemberId",value:function(e,t,n){var r="member-id="+e;this.addAuthorizationHeader(r,t,n)}},{key:"addAuthorizationHeaderUsername",value:function(e,t,n){var r="username="+e;this.addAuthorizationHeader(r,t,n)}},{key:"addAuthorizationHeader",value:function(t,n,r){var a=n.url.replace(this._baseUrl,"");a="/"===a.substring(0,1)?a:a+"/",a="/"===a.substring(a.length-1)?a.substring(0,a.length-1):a,a.indexOf("?")>=0&&(a=a.substring(0,a.indexOf("?")));var u={method:n.method.toUpperCase(),uriHost:this._baseUrl.replace("http://","").replace("https://",""),uriPath:a};void 0!==n.data&&""!==n.data&&(u.requestBody=c(n.data)),n.url.indexOf("?")!==-1&&(u.queryString=n.url.substring(n.url.indexOf("?")+1));var o=s["default"].signJson(u,this._keys),f=i.signatureScheme+" "+t+",key-id="+this._keys.keyId+",signature="+o+e._onBehalfOfHeader(r);n.headers={Authorization:f}}}],[{key:"_onBehalfOfHeader",value:function(e){return void 0!==e&&void 0!==e.onBehalfOf&&""!==e.onBehalfOf?",on-behalf-of="+e.onBehalfOf:""}}]),e}();t["default"]=f},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="Token-Ed25519-SHA512",r={local:"http://localhost:8000",dev:"http://dev.api.token.io",stg:"http://stg.api.token.io",prd:"http://prd.api.token.io"},a="1.0",u="1.0",i="EUR";t.signatureScheme=n,t.urls=r,t.transferTokenVersion=a,t.accessTokenVersion=u,t.defaultCurrency=i},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){n(this,e),this._onBehalfOf=void 0}return r(e,[{key:"onBehalfOf",set:function(e){this._onBehalfOf=e},get:function(){return this._onBehalfOf}}]),e}();t["default"]=a},function(e,t){e.exports=require("axios")},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t,r){n(this,e),this._status=t.status,this._token=r}return r(e,[{key:"status",get:function(){return this._status}},{key:"token",get:function(){return this._token}}],[{key:"Status",get:function(){return{INVALID:"INVALID",SUCCESS:"SUCCESS",MORE_SIGNATURES_NEEDED:"MORE_SIGNATURES_NEEDED"
}}}]),e}();t["default"]=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(6),o=r(i),s=n(20),c=function(){function e(t,n,r,u,i,c,f){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:s.transferTokenVersion,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:void 0,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:void 0,y=arguments.length>10&&void 0!==arguments[10]?arguments[10]:[];a(this,e),this._id=t,this._from=n,this._instructions=r,this._amount=u,this._currency=i,this._redeemer=c,this._description=f,this._version=l,this._issuer=d,this._nonce=h,this._payloadSignatures=y,void 0===h&&(this._nonce=o["default"].generateNonce())}return u(e,null,[{key:"createFromToken",value:function(t){var n=t.id,r=t.payload.from,a=t.payload.transfer.instructions,u=parseFloat(t.payload.transfer.amount),i=t.payload.transfer.currency,o=t.payload.transfer.redeemer,s=t.payload.description,c=t.payload.version,f=t.payload.issuer,l=t.payload.nonce,d=t.payloadSignatures;return new e(n,r,a,u,i,o,s,c,f,l,d)}},{key:"create",value:function(t,n,r,a,u,i){var o={id:t.id},s={username:u},c={source:{accountId:n}};return new e((void 0),o,c,r,a,s,i)}}]),u(e,[{key:"payloadSignatures",set:function(e){this._payloadSignatures=[];var t=!0,n=!1,r=void 0;try{for(var a,u=e[Symbol.iterator]();!(t=(a=u.next()).done);t=!0){var i=a.value;this._payloadSignatures.push(i)}}catch(o){n=!0,r=o}finally{try{!t&&u["return"]&&u["return"]()}finally{if(n)throw r}}},get:function(){return this._payloadSignatures}},{key:"id",get:function(){return this._id}},{key:"from",get:function(){return this._from}},{key:"amount",get:function(){return this._amount}},{key:"currency",get:function(){return this._currency}},{key:"redeemer",get:function(){return this._redeemer}},{key:"description",get:function(){return this._description}},{key:"version",get:function(){return this._version}},{key:"issuer",get:function(){return this._issuer}},{key:"nonce",get:function(){return this._nonce}},{key:"json",get:function(){var e={version:this._version,nonce:this._nonce,from:this._from,transfer:{currency:this._currency,amount:this._amount.toString(),instructions:this._instructions}};return void 0!==this._redeemer&&(e.transfer.redeemer=this._redeemer),""!==this._description&&(e.description=this._description),void 0!==this._issuer&&(e.issuer=this._issuer),e}}]),e}();t["default"]=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(6),o=r(i),s=n(20),c=function(){function e(t,n,r,u){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:s.accessTokenVersion,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0,f=arguments[6],l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[];a(this,e),this._id=t,this._from=n,this._to=r,this._resources=u,this._version=i,this._nonce=c,this._issuer=f,this._payloadSignatures=l,void 0===c&&(this._nonce=o["default"].generateNonce())}return u(e,null,[{key:"addressesAccessToken",value:function(t,n){var r={id:t.id},a={username:n},u={allAddresses:{}};return new e((void 0),r,a,[u])}},{key:"addressAccessToken",value:function(t,n,r){var a={id:t.id},u={username:n},i={address:{addressId:r}};return new e((void 0),a,u,[i])}},{key:"accountsAccessToken",value:function(t,n){var r={id:t.id},a={username:n},u={allAccounts:{}};return new e((void 0),r,a,[u])}},{key:"accountAccessToken",value:function(t,n,r){var a={id:t.id},u={username:n},i={account:{accountId:r}};return new e((void 0),a,u,[i])}},{key:"accountsTransactionsAccessToken",value:function(t,n){var r={id:t.id},a={username:n},u={allTransactions:{}};return new e((void 0),r,a,[u])}},{key:"accountTransactionsAccessToken",value:function(t,n,r){var a={id:t.id},u={username:n},i={transactions:{accountId:r}};return new e((void 0),a,u,[i])}},{key:"balancesAccessToken",value:function(t,n){var r={id:t.id},a={username:n},u={allBalances:{}};return new e((void 0),r,a,[u])}},{key:"balanceAccessToken",value:function(t,n,r){var a={id:t.id},u={username:n},i={balance:{accountId:r}};return new e((void 0),a,u,[i])}},{key:"createFromToken",value:function(t){var n=t.id,r=t.payload.from,a=t.payload.to,u=t.payload.access.resources,i=t.payload.version,o=t.payload.nonce,s=t.payload.issuer,c=t.payloadSignatures;return new e(n,r,a,u,i,o,s,c)}}]),u(e,[{key:"payloadSignatures",set:function(e){this._payloadSignatures=[];var t=!0,n=!1,r=void 0;try{for(var a,u=e[Symbol.iterator]();!(t=(a=u.next()).done);t=!0){var i=a.value;this._payloadSignatures.push(i)}}catch(o){n=!0,r=o}finally{try{!t&&u["return"]&&u["return"]()}finally{if(n)throw r}}},get:function(){return this._payloadSignatures}},{key:"id",get:function(){return this._id}},{key:"version",get:function(){return this._version}},{key:"nonce",get:function(){return this._nonce}},{key:"from",get:function(){return this._from}},{key:"to",get:function(){return this._to}},{key:"issuer",get:function(){return this._issuer}},{key:"resources",get:function(){return this._resources}},{key:"json",get:function(){return{version:this._version,nonce:this._nonce,from:this._from,to:this._to,issuer:this._issuer,access:{resources:this._resources}}}}]),e}();t["default"]=c},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){n(this,e),this._id=t.id,this._referenceId=t.referenceId,this._payload=JSON.parse(JSON.stringify(t.payload)),this._payloadSignatures=JSON.parse(JSON.stringify(t.payloadSignatures))}return r(e,[{key:"id",get:function(){return this._id}},{key:"referenceId",get:function(){return this._referenceId}},{key:"payload",get:function(){return this._payload}},{key:"amount",get:function(){return this._payload.amount.value}},{key:"currency",get:function(){return this._payload.amount.currency}},{key:"instructions",get:function(){return this._payload.instructions}},{key:"payloadSignatures",get:function(){return this._payloadSignatures}}]),e}();t["default"]=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),o=r(i),s=n(17),c=r(s),f=n(20),l=n(22),d=function(){function e(t){a(this,e),this._instance=l.create({baseURL:f.urls[t]})}return u(e,[{key:"createMemberId",value:function(){var e={method:"post",url:"/members"};return this._instance(e)}},{key:"usernameExists",value:function(e){var t={method:"get",url:"/username-exists?username="+e};return this._instance(t)}},{key:"notify",value:function(e,t){var n={username:e,notification:t},r={method:"post",url:"/notify",data:n};return this._instance(r)}},{key:"addFirstKey",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c["default"].PRIVILEGED,r={memberId:t,addKey:{publicKey:o["default"].strKey(e.publicKey)}};n!==c["default"].PRIVILEGED&&(r.addKey.level=n);var a={update:r,updateSignature:{memberId:t,keyId:e.keyId,signature:o["default"].signJson(r,e)}},u={method:"post",url:"/members/"+t+"/updates",data:a};return this._instance(u)}}]),e}();t["default"]=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(19),o=r(i),s=n(20),c=(n(5),n(22)),f=function(){function e(t,n,r){a(this,e),this._instance=c.create({baseURL:s.urls[t]});var u=new o["default"](s.urls[t],r);this._instance.interceptors.request.use(function(e){return u.addAuthorizationHeaderUsername(n,e,void 0),e})}return u(e,[{key:"getMemberByUsername",value:function(){var e={method:"get",url:"/members"};return this._instance(e)}}]),e}();t["default"]=f},function(e,t){e.exports=require("es6-promise")}])});
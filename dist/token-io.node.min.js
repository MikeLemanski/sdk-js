!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("fast-sha256"),require("base64url"),require("supercop.js"),require("json-stable-stringify"),require("axios"),require("es6-promise")):"function"==typeof define&&define.amd?define("token-io.node",["fast-sha256","base64url","supercop.js","json-stable-stringify","axios","es6-promise"],t):"object"==typeof exports?exports["token-io.node"]=t(require("fast-sha256"),require("base64url"),require("supercop.js"),require("json-stable-stringify"),require("axios"),require("es6-promise")):e["token-io.node"]=t(e["fast-sha256"],e.base64url,e["supercop.js"],e["json-stable-stringify"],e.axios,e["es6-promise"])}(this,function(e,t,n,r,i,a){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),o=r(u),s=n(6),c=r(s),f=n(7),l=r(f),d=n(14),h=r(d),y=n(8),v=r(y),_=n(23),k=r(_),m=n(24),p=r(m);n(25).polyfill();var g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"prd";i(this,e),this._env=t,this._unauthenticatedClient=new k["default"](t),this.Crypto=o["default"],this.Util=c["default"],this.KeyLevel=h["default"]}return a(e,[{key:"usernameExists",value:function(e){var t=this;return this._unauthenticatedClient.usernameExists(e).then(function(e){return!!e.data.exists&&e.data.exists})["catch"](function(e){return t._reject(t.usernameExists,e)})}},{key:"createMember",value:function(e){var t=this,n=o["default"].generateKeys();return this._unauthenticatedClient.createMemberId().then(function(r){return t._unauthenticatedClient.addFirstKey(n,r.data.memberId).then(function(){var i=new l["default"](t._env,r.data.memberId,n);return i.addUsername(e).then(function(){return i})})})["catch"](function(e){return t._reject(t.createMember,e)})}},{key:"login",value:function(e,t){var n=this;return Promise.resolve(new l["default"](this._env,e,t))["catch"](function(e){return n._reject(n.login,e)})}},{key:"loginWithUsername",value:function(e,t){var n=this;return new p["default"](this._env,t,e).getMemberByUsername().then(function(t){return new l["default"](n._env,t.data.member.id,e)})["catch"](function(e){return n._reject(n.loginWithUsername,e)})}},{key:"loginFromLocalStorage",value:function(){var e=this;return Promise.resolve(v["default"].loadMember())["catch"](function(t){return e._reject(e.loginFromLocalStorage,t)})}},{key:"notifyLinkAccounts",value:function(e,t,n,r){var i=this,a={linkAccounts:{bankId:t,bankName:n,accountsLinkPayload:r}};return this._unauthenticatedClient.notify(e,a)["catch"](function(e){return i._reject(i.notifyLinkAccounts,e)})}},{key:"notifyAddKey",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i={addKey:{publicKey:o["default"].strKey(t),name:r}};return this._unauthenticatedClient.notify(e,i)["catch"](function(e){return n._reject(n.notifyAddKey,e)})}},{key:"notifyLinkAccountsAndAddKey",value:function(e,t,n,r,i){var a=this,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",s={linkAccountsAndAddKey:{linkAccounts:{bankId:t,bankName:n,accountsLinkPayload:r},addKey:{publicKey:o["default"].strKey(i),name:u}}};return this._unauthenticatedClient.notify(e,s)["catch"](function(e){return a._reject(a.notifyLinkAccountsAndAddKey,e)})}},{key:"_reject",value:function(e,t){return Promise.reject({type:e.name,error:t,reason:void 0!==t.response.data?t.response.data:"UNKNOWN"})}}]),e}();e.exports=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(2),o=r(u),s=n(3),c=r(s),f=n(4),l=n(5),d=function(){function e(){i(this,e)}return a(e,null,[{key:"generateKeys",value:function(){var e=f.createSeed(),t=f.createKeyPair(e);return t.keyId=(0,c["default"])((0,o["default"])(t.publicKey)).substring(0,16),t}},{key:"signJson",value:function(t,n){return e.sign(l(t),n)}},{key:"sign",value:function(e,t){var n=new Buffer(e);return(0,c["default"])(f.sign(n,t.publicKey,t.secretKey))}},{key:"strKey",value:function(e){return(0,c["default"])(e)}},{key:"bufferKey",value:function(e){return c["default"].toBuffer(e)}}]),e}();t["default"]=d},function(e,t){e.exports=require("fast-sha256")},function(e,t){e.exports=require("base64url")},function(e,t){e.exports=require("supercop.js")},function(e,t){e.exports=require("json-stable-stringify")},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(4),u=function(){function e(){r(this,e)}return i(e,null,[{key:"generateNonce",value:function(){return a.createSeed().toString("base64")}}]),e}();t["default"]=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),o=r(u),s=n(8),c=r(s),f=n(9),l=r(f),d=n(12),h=r(d),y=n(13),v=r(y),_=n(14),k=r(_),m=n(15),p=r(m),g=n(10),b=r(g),T=n(20),j=r(T),w=n(21),A=r(w),I=n(22),O=r(I),P=n(17),S=function(){function e(t,n,r){i(this,e),this._id=n,this._keys=r,this._client=new p["default"](t,n,r)}return a(e,[{key:"saveToLocalStorage",value:function(){c["default"].saveMember(this)}},{key:"useAccessToken",value:function(e){this._client.useAccessToken(e)}},{key:"clearAccessToken",value:function(){this._client.clearAccessToken()}},{key:"approveKey",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k["default"].PRIVILEGED;return this._getPreviousHash().then(function(r){return t._client.addKey(r,o["default"].bufferKey(e),n).then(function(e){})})["catch"](function(e){return t._reject(t.approveKey,e)})}},{key:"removeKey",value:function(e){var t=this;return this._getPreviousHash().then(function(n){return t._client.removeKey(n,e).then(function(e){})})["catch"](function(e){return t._reject(t.removeKey,e)})}},{key:"addUsername",value:function(e){var t=this;return this._getPreviousHash().then(function(n){return t._client.addUsername(n,e).then(function(e){})})["catch"](function(e){return t._reject(t.addUsername,e)})}},{key:"removeUsername",value:function(e){var t=this;return this._getPreviousHash().then(function(n){return t._client.removeUsername(n,e).then(function(e){})})["catch"](function(e){return t._reject(t.removeUsername,e)})}},{key:"linkAccounts",value:function(e,t){var n=this;return this._client.linkAccounts(e,t).then(function(e){return e.data.accounts.map(function(e){return new l["default"](n,e)})})["catch"](function(e){return n._reject(n.linkAccounts,e)})}},{key:"getAccounts",value:function(){var e=this;return this._client.getAccounts().then(function(t){return t.data.accounts.map(function(t){return new l["default"](e,t)})})["catch"](function(t){return e._reject(e.getAccounts,t)})}},{key:"subscribeToNotifications",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P.defaultNotificationProvider,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"IOS";return this._client.subscribeToNotifications(e,n,r).then(function(e){return new h["default"](e.data.subscriber)})["catch"](function(e){return t._reject(t.subscribeToNotifications,e)})}},{key:"getSubscribers",value:function(){var e=this;return this._client.getSubscribers().then(function(e){return e.data.subscribers.map(function(e){return new h["default"](e)})})["catch"](function(t){return e._reject(e.getSubscribers,t)})}},{key:"getSubscriber",value:function(e){var t=this;return this._client.getSubscriber(e).then(function(e){return new h["default"](e.data.subscriber)})["catch"](function(e){return t._reject(t.getSubscriber,e)})}},{key:"unsubscribeFromNotifications",value:function(e){var t=this;return this._client.unsubscribeFromNotifications(e)["catch"](function(e){return t._reject(t.unsubscribeFromNotifications,e)})}},{key:"addAddress",value:function(e,t){var n=this;return this._client.addAddress(e,t).then(function(e){return new v["default"](e.data.address)})["catch"](function(e){return n._reject(n.addAddress,e)})}},{key:"getAddress",value:function(e){var t=this;return this._client.getAddress(e).then(function(e){return new v["default"](e.data.address)})["catch"](function(e){return t._reject(t.getAddress,e)})}},{key:"getAddresses",value:function(){var e=this;return this._client.getAddresses().then(function(e){return e.data.addresses.map(function(e){return new v["default"](e)})})["catch"](function(t){return e._reject(e.getAddresses,t)})}},{key:"getAllUsernames",value:function(){var e=this;return this._getMember().then(function(e){return e.usernames})["catch"](function(t){return e._reject(e.getAllUsernames,t)})}},{key:"createAccessToken",value:function(e,t){var n=this,r=new A["default"]((void 0),this,e,t);return this._client.createToken(r.json).then(function(e){return A["default"].createFromToken(e.data.token)})["catch"](function(e){return n._reject(n.createAccessToken,e)})}},{key:"createAddressAccessToken",value:function(e,t){var n=this,r=A["default"].addressAccessToken(this,e,t);return this._client.createToken(r.json).then(function(e){return A["default"].createFromToken(e.data.token)})["catch"](function(e){return n._reject(n.createAddressAccessToken,e)})}},{key:"createAccountAccessToken",value:function(e,t){var n=this,r=A["default"].accountAccessToken(this,e,t);return this._client.createToken(r.json).then(function(e){return A["default"].createFromToken(e.data.token)})["catch"](function(e){return n._reject(n.createAccountAccessToken,e)})}},{key:"createTransactionAccessToken",value:function(e,t){var n=this,r=A["default"].transactionAccessToken(this,e,t);return this._client.createToken(r.json).then(function(e){return A["default"].createFromToken(e.data.token)})["catch"](function(e){return n._reject(n.createTransactionAccessToken,e)})}},{key:"createToken",value:function(e,t,n,r){var i=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,u=j["default"].create(this,e,t,n,r,a);return this._client.createToken(u.json).then(function(e){return j["default"].createFromToken(e.data.token)})["catch"](function(e){return i._reject(i.createToken,e)})}},{key:"getToken",value:function(e){var t=this;return this._client.getToken(e).then(function(e){return j["default"].createFromToken(e.data.token)})["catch"](function(e){return t._reject(t.getToken,e)})}},{key:"getTransferTokens",value:function(e,t){var n=this;return this._client.getTokens("TRANSFER",e,t).then(function(e){return new b["default"](void 0===e.data.tokens?[]:e.data.tokens.map(function(e){return j["default"].createFromToken(e)}),e.data.offset)})["catch"](function(e){return n._reject(n.getTransferTokens,e)})}},{key:"getAccessTokens",value:function(e,t){var n=this;return this._client.getTokens("ACCESS",e,t).then(function(e){return new b["default"](void 0===e.data.tokens?[]:e.data.tokens.map(function(e){return j["default"].createFromToken(e)}),e.data.offset)})["catch"](function(e){return n._reject(n.getAccessTokens,e)})}},{key:"endorseToken",value:function(e){var t=this;return this._resolveToken(e).then(function(n){return t._client.endorseToken(n).then(function(t){"string"==typeof e||e instanceof String||(e.payloadSignatures=t.data.token.payloadSignatures)})})["catch"](function(e){return t._reject(t.endorseToken,e)})}},{key:"cancelToken",value:function(e){var t=this;return this._resolveToken(e).then(function(n){return t._client.cancelToken(n).then(function(t){"string"==typeof e||e instanceof String||(e.payloadSignatures=t.data.token.payloadSignatures)})})["catch"](function(e){return t._reject(t.cancelToken,e)})}},{key:"createTransfer",value:function(e,t,n){var r=this;return this._resolveToken(e).then(function(e){return void 0===t&&(t=e.payload.transfer.amount),void 0===n&&(n=e.payload.transfer.currency),r._client.createTransfer(e,t,n).then(function(e){return new O["default"](e.data.transfer)})})["catch"](function(e){return r._reject(r.createTransfer,e)})}},{key:"getTransfer",value:function(e){var t=this;return this._client.getTransfer(e).then(function(e){return new O["default"](e.data.transfer)})["catch"](function(e){return t._reject(t.getTransfer,e)})}},{key:"getTransfers",value:function(e,t,n){var r=this;return this._client.getTransfers(e,t,n).then(function(e){return new b["default"](e.data.transfers.map(function(e){return new O["default"](e)}),e.data.offset)})["catch"](function(e){return r._reject(r.getTransfers,e)})}},{key:"getPublicKeys",value:function(){var e=this;return this._getMember().then(function(e){return e.keys})["catch"](function(t){return e._reject(e.getPublicKeys,t)})}},{key:"_getPreviousHash",value:function(){var e=this;return this._getMember().then(function(e){return e.lastHash})["catch"](function(t){return e._reject(e._getPreviousHash,t)})}},{key:"_getMember",value:function(){var e=this;return this._client.getMember().then(function(e){return e.data.member})["catch"](function(t){return e._reject(e._getMember,t)})}},{key:"_resolveToken",value:function(e){var t=this;return new Promise(function(n,r){"string"==typeof e||e instanceof String?t.getToken(e).then(function(e){return n(e)}):n(e)})}},{key:"_reject",value:function(e,t){return Promise.reject({type:e.name,error:t,reason:void 0!==t.response.data?t.response.data:"UNKNOWN"})}},{key:"id",get:function(){return this._id}},{key:"keys",get:function(){return this._keys}}]),e}();t["default"]=S},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(7),o=(r(u),n(1)),s=(r(o),function(){function e(){i(this,e)}return a(e,null,[{key:"saveMember",value:function(e){throw new Error("Browser Only")}},{key:"loadMember",value:function(){throw new Error("Browser Only")}}]),e}());t["default"]=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(10),o=r(u),s=n(11),c=r(s),f=function(){function e(t,n){i(this,e),this._member=t,this._id=n.id,this._name=n.name}return a(e,[{key:"getBalance",value:function(){var e=this;return this._member._client.getBalance(this._id).then(function(e){return e.data})["catch"](function(t){return e._reject(e.getBalance,t)})}},{key:"getTransaction",value:function(e){var t=this;return this._member._client.getTransaction(this._id,e).then(function(e){return new c["default"](e.data.transaction)})["catch"](function(e){return t._reject(t.getTransaction,e)})}},{key:"getTransactions",value:function(e,t){var n=this;return this._member._client.getTransactions(this._id,e,t).then(function(e){return new o["default"](e.data.transactions.map(function(e){return new c["default"](e)}),e.data.offset)})["catch"](function(e){return n._reject(n.getTransactions,e)})}},{key:"_reject",value:function(e,t){return Promise.reject({type:e.name,error:t,reason:void 0!==t.response.data?t.response.data:"UNKNOWN"})}},{key:"member",get:function(){return this._member}},{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}}]),e}();t["default"]=f},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,r){n(this,e),this._data=t,this._offset=r}return r(e,[{key:"address",get:function(){return this._data}},{key:"offset",get:function(){return this._offset}}]),e}();t["default"]=i},function(e, t){"use strict";function n(e, t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e, t){for(var n=0; n<t.length; n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t, n, r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){n(this,e),this._id=t.id,this._type=t.type,this._currency=t.amount.currency,this._amount=parseFloat(t.amount.value),this._description=t.description,this._tokenId=t.tokenId,this._tokenTransferId=t.tokenTransferId}return r(e,[{key:"id",get:function(){return this._id}},{key:"type",get:function(){return this._type}},{key:"amount",get:function(){return this._amount}},{key:"currency",get:function(){return this._currency}},{key:"description",get:function(){return this._description}},{key:"tokenId",get:function(){return this._tokenId}},{key:"tokenTransferId",get:function(){return this._tokenTransferId}}]),e}();t["default"]=i},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){n(this,e),this._id=t.id,this._target=t.target,this._platform=t.platform}return r(e,[{key:"id",get:function(){return this._id}},{key:"target",get:function(){return this._target}},{key:"platform",get:function(){return this._platform}}]),e}();t["default"]=i},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e, t){for(var n=0; n<t.length; n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t, n, r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){n(this,e),this._id=t.id,this._name=t.name,this._data=t.payload,this._dataSignature=t.payloadSignature}return r(e,[{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}},{key:"address",get:function(){return this._data}},{key:"dataSignature",get:function(){return this._dataSignature}}]),e}();t["default"]=i},function(e, t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={PRIVILEGED:"PRIVILEGED",STANDARD:"STANDARD",LOW:"LOW"}},function(e, t, n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e, t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),o=r(u),s=n(6),c=r(s),f=n(16),l=r(f),d=n(18),h=r(d),y=n(17),v=n(14),_=r(v),k=n(5),m=n(19),p=function(){function e(t,n,r){i(this,e),this._instance=m.create({baseURL:y.urls[t]}),this._memberId=n,this._keys=r,this._context=new h["default"],this._authHeader=new l["default"](y.urls[t],r),this._resetInterceptor()}return a(e,[{key:"_resetInterceptor",value:function(){var e=this;this._instance.interceptors.request.eject(this._interceptor),this._interceptor=this._instance.interceptors.request.use(function(t){return e._authHeader.addAuthorizationHeaderMemberId(e._memberId,t,e._context),t})}},{key:"useAccessToken",value:function(e){this._context.onBehalfOf=e,this._resetInterceptor()}},{key:"clearAccessToken",value:function(){this._context.onBehalfOf=void 0,this._resetInterceptor()}},{key:"subscribeToNotifications",value:function(e,t,n){var r={provider:t,target:e,platform:n},i={method:"post",url:"/subscribers",data:r};return this._instance(i)}},{key:"getSubscribers",value:function(){var e={method:"get",url:"/subscribers"};return this._instance(e)}},{key:"getSubscriber",value:function(e){var t={method:"get",url:"/subscribers/"+e};return this._instance(t)}},{key:"unsubscribeFromNotifications",value:function(e){var t={method:"delete",url:"/subscribers/"+e};return this._instance(t)}},{key:"addAddress",value:function(e,t){var n={name:e,data:t,dataSignature:{keyId:this._keys.keyId,signature:o["default"].sign(t,this._keys),timestampMs:(new Date).getTime()}},r={method:"post",url:"/addresses",data:n};return this._instance(r)}},{key:"getAddress",value:function(e){var t={method:"get",url:"/addresses/"+e};return this._instance(t)}},{key:"getAddresses",value:function(){var e={method:"get",url:"/addresses"};return this._instance(e)}},{key:"linkAccounts",value:function(e,t){var n={bankId:e,accountsLinkPayload:t},r={method:"post",url:"/accounts",data:n};return this._instance(r)}},{key:"getAccounts",value:function(){var e={method:"get",url:"/accounts"};return this._instance(e)}},{key:"setAccountName",value:function(e,t){var n={method:"patch",url:"/accounts/"+e+"?name="+t};return this._instance(n)}},{key:"getBalance",value:function(e){var t={method:"get",url:"/accounts/"+e+"/balance"};return this._instance(t)}},{key:"getTransaction",value:function(e,t){var n={method:"get",url:"/accounts/"+e+"/transactions/"+t};return this._instance(n)}},{key:"getTransactions",value:function(e,t,n){var r={method:"get",url:"/accounts/"+e+"/transactions?offset="+t+"&limit="+n};return this._instance(r)}},{key:"createToken",value:function(e){var t={method:"post",url:"/tokens",data:{payload:e}};return this._instance(t)}},{key:"endorseToken",value:function(e){return this._tokenOperation(e,"endorse","endorsed")}},{key:"cancelToken",value:function(e){return this._tokenOperation(e,"cancel","cancelled")}},{key:"_tokenOperation",value:function(e,t,n){var r=k(e.json)+("."+n),i={tokenId:e.id,signature:{keyId:this._keys.keyId,signature:o["default"].sign(r,this._keys),timestampMs:(new Date).getTime()}},a=e.id,u={method:"put",url:"/tokens/"+a+"/"+t,data:i};return this._instance(u)}},{key:"createTransfer",value:function(e,t,n){var r={nonce:c["default"].generateNonce(),tokenId:e.id,amount:{value:t.toString(),currency:n},transfer:e.transfer},i={payload:r,payloadSignature:{keyId:this._keys.keyId,signature:o["default"].signJson(r,this._keys),timestampMs:(new Date).getTime()}},a={method:"post",url:"/transfers",data:i};return this._instance(a)}},{key:"getToken",value:function(e){var t={method:"get",url:"/tokens/"+e};return this._instance(t)}},{key:"getTokens",value:function(e,t,n){var r={method:"get",url:"/tokens?type="+e+"&offset="+t+"&limit="+n};return this._instance(r)}},{key:"getTransfer",value:function(e){var t={method:"get",url:"/transfers/"+e};return this._instance(t)}},{key:"getTransfers",value:function(e,t,n){var r={method:"get",url:"/transfers?tokenId="+e+"&offset="+t+"&limit="+n};return this._instance(r)}},{key:"getMember",value:function(){var e={method:"get",url:"/members"};return this._instance(e)}},{key:"addKey",value:function(e,t,n){var r={memberId:this._memberId,addKey:{publicKey:o["default"].strKey(t)}};return n!==_["default"].PRIVILEGED&&(r.addKey.level=n),this._memberUpdate(r,e)}},{key:"removeKey",value:function(e,t){var n={memberId:this._memberId,removeKey:{keyId:t}};return this._memberUpdate(n,e)}},{key:"addUsername",value:function(e,t){var n={memberId:this._memberId,addUsername:{username:t}};return this._memberUpdate(n,e)}},{key:"removeUsername",value:function(e,t){var n={memberId:this._memberId,removeUsername:{username:t}};return this._memberUpdate(n,e)}},{key:"_memberUpdate",value:function(e,t){""!==t&&(e.prevHash=t);var n={update:e,updateSignature:{keyId:this._keys.keyId,signature:o["default"].signJson(e,this._keys),timestampMs:(new Date).getTime()}},r={method:"post",url:"/members/"+this._memberId+"/updates",data:n};return this._instance(r)}}]),e}();t["default"]=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(17),o=n(1),s=r(o),c=n(5),f=function(){function e(t,n){i(this,e),this._baseUrl=t,this._keys=n}return a(e,[{key:"addAuthorizationHeaderMemberId",value:function(e,t,n){var r="member-id="+e;this.addAuthorizationHeader(r,t,n)}},{key:"addAuthorizationHeaderUsername",value:function(e,t,n){var r="username="+e;this.addAuthorizationHeader(r,t,n)}},{key:"addAuthorizationHeader",value:function(t,n,r){var i=n.url.replace(this._baseUrl,"");i="/"===i.substring(0,1)?i:i+"/",i="/"===i.substring(i.length-1)?i.substring(0,i.length-1):i,i.includes("?")&&(i=i.substring(0,i.indexOf("?")));var a={method:n.method.toUpperCase(),uriHost:this._baseUrl.replace("http://","").replace("https://",""),uriPath:i};void 0!==n.data&&""!==n.data&&(a.requestBody=c(n.data)),n.url.indexOf("?")!==-1&&(a.queryString=n.url.substring(n.url.indexOf("?")+1));var o=s["default"].signJson(a,this._keys),f=u.signatureScheme+" "+t+",key-id="+this._keys.keyId+",signature="+o+e._onBehalfOfHeader(r);n.headers={Authorization:f}}}],[{key:"_onBehalfOfHeader",value:function(e){return void 0!==e&&void 0!==e.onBehalfOf&&""!==e.onBehalfOf?",on-behalf-of="+e.onBehalfOf:""}}]),e}();t["default"]=f},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="Token-Ed25519-SHA512",r={local:"http://localhost:8000",dev:"http://dev.api.token.io",stg:"http://stg.api.token.io",prd:"http://prd.api.token.io"},i="1.0",a="1.0",u="EUR",o="Token";t.signatureScheme=n,t.urls=r,t.transferTokenVersion=i,t.accessTokenVersion=a,t.defaultCurrency=u,t.defaultNotificationProvider=o},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){n(this,e),this._onBehalfOf=void 0}return r(e,[{key:"onBehalfOf",set:function(e){this._onBehalfOf=e},get:function(){return this._onBehalfOf}}]),e}();t["default"]=i},function(e,t){e.exports=require("axios")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(6),o=r(u),s=n(17),c=function(){function e(t,n,r,a,u,c,f){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:s.transferTokenVersion,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:void 0,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:void 0,y=arguments.length>10&&void 0!==arguments[10]?arguments[10]:[];i(this,e),this._id=t,this._from=n,this._instructions=r,this._amount=a,this._currency=u,this._redeemer=c,this._description=f,this._version=l,this._issuer=d,this._nonce=h,this._payloadSignatures=y,void 0===h&&(this._nonce=o["default"].generateNonce())}return a(e,null,[{key:"createFromToken",value:function(t){var n=t.id,r=t.payload.from,i=t.payload.transfer.instructions,a=parseFloat(t.payload.transfer.amount),u=t.payload.transfer.currency,o=t.payload.transfer.redeemer,s=t.payload.description,c=t.payload.version,f=t.payload.issuer,l=t.payload.nonce,d=t.payloadSignatures;return new e(n,r,i,a,u,o,s,c,f,l,d)}},{key:"create",value:function(t,n,r,i,a,u){var o={id:t.id},s={username:a},c={source:{accountId:n}};return new e((void 0),o,c,r,i,s,u)}}]),a(e,[{key:"payloadSignatures",set:function(e){this._payloadSignatures=[];var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var u=i.value;this._payloadSignatures.push(u)}}catch(o){n=!0,r=o}finally{try{!t&&a["return"]&&a["return"]()}finally{if(n)throw r}}},get:function(){return this._payloadSignatures}},{key:"id",get:function(){return this._id}},{key:"from",get:function(){return this._from}},{key:"amount",get:function(){return this._amount}},{key:"currency",get:function(){return this._currency}},{key:"redeemer",get:function(){return this._redeemer}},{key:"description",get:function(){return this._description}},{key:"version",get:function(){return this._version}},{key:"issuer",get:function(){return this._issuer}},{key:"nonce",get:function(){return this._nonce}},{key:"json",get:function(){var e={version:this._version,nonce:this._nonce,from:this._from,transfer:{currency:this._currency,amount:this._amount.toString(),instructions:this._instructions}};return void 0!==this._redeemer&&(e.transfer.redeemer=this._redeemer),""!==this._description&&(e.description=this._description),void 0!==this._issuer&&(e.issuer=this._issuer),e}}]),e}();t["default"]=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(6),o=r(u),s=n(17),c=function(){function e(t,n,r,a){var u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:s.accessTokenVersion,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0,f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[];i(this,e),this._id=t,this._from=n,this._to=r,this._resources=a,
this._version=u,this._nonce=c,this._payloadSignatures=f,void 0===c&&(this._nonce=o["default"].generateNonce())}return a(e,null,[{key:"addressAccessToken",value:function(t,n,r){var i={id:t.id},a={username:n},u={address:{addressId:r}};return new e((void 0),i,a,[u])}},{key:"accountAccessToken",value:function(t,n,r){var i={id:t.id},a={username:n},u={account:{accountId:r}};return new e((void 0),i,a,[u])}},{key:"transactionAccessToken",value:function(t,n,r){var i={id:t.id},a={username:n},u={transaction:{accountId:r}};return new e((void 0),i,a,[u])}},{key:"createFromToken",value:function(t){var n=t.id,r=t.payload.from,i=t.payload.to,a=t.payload.access.resources,u=t.payload.version,o=t.payload.nonce,s=t.payloadSignatures;return new e(n,u,o,r,i,a,s)}}]),a(e,[{key:"payloadSignatures",set:function(e){this._payloadSignatures=[];var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var u=i.value;this._payloadSignatures.push(u)}}catch(o){n=!0,r=o}finally{try{!t&&a["return"]&&a["return"]()}finally{if(n)throw r}}},get:function(){return this._payloadSignatures}},{key:"id",get:function(){return this._id}},{key:"version",get:function(){return this._version}},{key:"nonce",get:function(){return this._nonce}},{key:"from",get:function(){return this._from}},{key:"to",get:function(){return this._to}},{key:"resources",get:function(){return this._resources}},{key:"json",get:function(){return{version:this._version,nonce:this._nonce,from:this._from,to:this._to,access:{resources:this._resources}}}}]),e}();t["default"]=c},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){n(this,e),this._id=t.id,this._referenceId=t.referenceId,this._payload=JSON.parse(JSON.stringify(t.payload)),this._payloadSignatures=JSON.parse(JSON.stringify(t.payloadSignatures))}return r(e,[{key:"id",get:function(){return this._id}},{key:"referenceId",get:function(){return this._referenceId}},{key:"payload",get:function(){return this._payload}},{key:"amount",get:function(){return this._payload.amount.value}},{key:"currency",get:function(){return this._payload.amount.currency}},{key:"instructions",get:function(){return this._payload.instructions}},{key:"payloadSignatures",get:function(){return this._payloadSignatures}}]),e}();t["default"]=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),o=r(u),s=n(14),c=r(s),f=n(17),l=n(19),d=function(){function e(t){i(this,e),this._instance=l.create({baseURL:f.urls[t]})}return a(e,[{key:"createMemberId",value:function(){var e={method:"post",url:"/members"};return this._instance(e)}},{key:"usernameExists",value:function(e){var t={method:"get",url:"/username-exists?username="+e};return this._instance(t)}},{key:"notify",value:function(e,t){var n={username:e,notification:t},r={method:"post",url:"/notify",data:n};return this._instance(r)}},{key:"addFirstKey",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c["default"].PRIVILEGED,r={memberId:t,addKey:{publicKey:o["default"].strKey(e.publicKey)}};n!==c["default"].PRIVILEGED&&(r.addKey.level=n);var i={update:r,updateSignature:{keyId:e.keyId,signature:o["default"].signJson(r,e),timestampMs:(new Date).getTime()}},a={method:"post",url:"/members/"+t+"/updates",data:i};return this._instance(a)}}]),e}();t["default"]=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(16),o=r(u),s=n(17),c=(n(5),n(19)),f=function(){function e(t,n,r){i(this,e),this._instance=c.create({baseURL:s.urls[t]});var a=new o["default"](s.urls[t],r);this._instance.interceptors.request.use(function(e){return a.addAuthorizationHeaderUsername(n,e,void 0),e})}return a(e,[{key:"getMemberByUsername",value:function(){var e={method:"get",url:"/members"};return this._instance(e)}}]),e}();t["default"]=f},function(e,t){e.exports=require("es6-promise")}])});
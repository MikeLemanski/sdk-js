!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("fast-sha256"),require("supercop.js"),require("bytebuffer"),require("fs"),require("path"),require("es6-promise"),require("axios")):"function"==typeof define&&define.amd?define("token.node",["fast-sha256","supercop.js","bytebuffer","fs","path","es6-promise","axios"],t):"object"==typeof exports?exports["token.node"]=t(require("fast-sha256"),require("supercop.js"),require("bytebuffer"),require("fs"),require("path"),require("es6-promise"),require("axios")):e["token.node"]=t(e["fast-sha256"],e["supercop.js"],e.bytebuffer,e.fs,e.path,e["es6-promise"],e.axios)}(this,function(e,t,r,i,n,s,o){return function(e){function t(i){if(r[i])return r[i].exports;var n=r[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var n=r(1),s=i(n),o={createMember:function(e){return s["default"].createMember(e)},login:function(e,t){}};e.exports=o},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=r(2),a=i(o),l=r(3),u=r(9),f=i(u),c=function(){function e(){n(this,e)}return s(e,null,[{key:"createMember",value:function(e){console.log("Creating member");var t=(0,l.generateKeys)();return f["default"].createMemberId().then(function(e){return f["default"].addFirstKey(t,e.data.memberId),new a["default"](e.data.memberId,[],[t])})["catch"](function(e){console.log("Error: ",e)})}}]),e}();t["default"]=c},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=function(){function e(t,i,n){r(this,e),this._memberId=t,this._aliases=i,this._privateKeys=n}return i(e,[{key:"doSomething",value:function(){console.log("Doing something in member")}},{key:"memberId",get:function(){return this._memberId}}]),e}();t["default"]=n},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function n(){var e=c.createSeed(),t=c.createKeyPair(e);return t.keyId=(0,f["default"])((0,l["default"])(t.publicKey)).substring(0,16),t}function s(e,t){var r=new Buffer(e);return(0,f["default"])(c.sign(r,t.publicKey,t.secretKey))}function o(e){return(0,f["default"])(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.strKey=t.sign=t.generateKeys=void 0;var a=r(4),l=i(a),u=r(5),f=i(u),c=r(8);t.generateKeys=n,t.sign=s,t.strKey=o},function(e,t){e.exports=require("fast-sha256")},function(e,t,r){e.exports=r(6)["default"],e.exports["default"]=e.exports},function(e,t,r){"use strict";function i(e,t){return void 0===t&&(t="utf8"),o(Buffer.isBuffer(e)?e.toString("base64"):new Buffer(e,t).toString("base64"))}function n(e,t){return void 0===t&&(t="utf8"),new Buffer(s(e),"base64").toString(t)}function s(e){return e=e.toString(),l["default"](e).replace(/\-/g,"+").replace(/_/g,"/")}function o(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function a(e){return new Buffer(s(e),"base64")}var l=r(7),u=i;u.encode=i,u.decode=n,u.toBase64=s,u.fromBase64=o,u.toBuffer=a,Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=u},function(e,t){"use strict";function r(e){var t=4,r=e.length,i=r%t;if(!i)return e;var n=r,s=t-i,o=r+s,a=new Buffer(o);for(a.write(e);s--;)a.write("=",n++);return a.toString()}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r},function(e,t){e.exports=require("supercop.js")},function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),s=r(3),o=r(10),a=r(!function(){var e=new Error('Cannot find module "./proto/gateway.proto"');throw e.code="MODULE_NOT_FOUND",e}());console.log("Def",a),console.log("Loader",o.loadJson(a)),r(17).polyfill();var l=r(18),u=l.create({baseURL:"http://localhost:8000"}),f=function(){function e(){i(this,e)}return n(e,null,[{key:"createMemberId",value:function(){return u({method:"post",url:"/members"})}},{key:"addFirstKey",value:function(e,t){var r=arguments.length<=2||void 0===arguments[2]?0:arguments[2],i=arguments.length<=3||void 0===arguments[3]?[]:arguments[3],n={prev_hash:"",member_id:t,operation:{publicKey:(0,s.strKey)(e.publicKey),level:r,tags:i}},a={update:n,signature:{key_id:e.keyId,signature:(0,s.sign)(JSON.stringify(n),e),timestamp:(new Date).getTime()}};console.log("JSON: ",JSON.stringify(a));var l=o.loadJson(JSON.stringify(a));return console.log("Req proto is:",l),console.log("Req is:",l.toString()),u({method:"post",url:"/members/"+t,data:a.toString()}).then(function(e){console.log("Response:",e)})["catch"](function(e){console.log("Error:",e)})}}]),e}();t["default"]=f},function(e,t,r){var i,n,s;(function(e){/**
	 * @license protobuf.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
	 * Released under the Apache License, Version 2.0
	 * see: https://github.com/dcodeIO/protobuf.js for details
	 */
!function(o,a){r(12).amd?(n=[r(13)],i=a,s="function"==typeof i?i.apply(t,n):i,!(void 0!==s&&(e.exports=s))):"object"==typeof e&&e&&e.exports?e.exports=a(r(13),!0):(o.dcodeIO=o.dcodeIO||{}).ProtoBuf=a(o.dcodeIO.ByteBuffer)}(this,function(e,t){"use strict";var i={};return i.ByteBuffer=e,i.Long=e.Long||null,i.VERSION="5.0.1",i.WIRE_TYPES={},i.WIRE_TYPES.VARINT=0,i.WIRE_TYPES.BITS64=1,i.WIRE_TYPES.LDELIM=2,i.WIRE_TYPES.STARTGROUP=3,i.WIRE_TYPES.ENDGROUP=4,i.WIRE_TYPES.BITS32=5,i.PACKABLE_WIRE_TYPES=[i.WIRE_TYPES.VARINT,i.WIRE_TYPES.BITS64,i.WIRE_TYPES.BITS32],i.TYPES={int32:{name:"int32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},uint32:{name:"uint32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},sint32:{name:"sint32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},int64:{name:"int64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.ZERO:void 0},uint64:{name:"uint64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.UZERO:void 0},sint64:{name:"sint64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.ZERO:void 0},bool:{name:"bool",wireType:i.WIRE_TYPES.VARINT,defaultValue:!1},"double":{name:"double",wireType:i.WIRE_TYPES.BITS64,defaultValue:0},string:{name:"string",wireType:i.WIRE_TYPES.LDELIM,defaultValue:""},bytes:{name:"bytes",wireType:i.WIRE_TYPES.LDELIM,defaultValue:null},fixed32:{name:"fixed32",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},sfixed32:{name:"sfixed32",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},fixed64:{name:"fixed64",wireType:i.WIRE_TYPES.BITS64,defaultValue:i.Long?i.Long.UZERO:void 0},sfixed64:{name:"sfixed64",wireType:i.WIRE_TYPES.BITS64,defaultValue:i.Long?i.Long.ZERO:void 0},"float":{name:"float",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},"enum":{name:"enum",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},message:{name:"message",wireType:i.WIRE_TYPES.LDELIM,defaultValue:null},group:{name:"group",wireType:i.WIRE_TYPES.STARTGROUP,defaultValue:null}},i.MAP_KEY_TYPES=[i.TYPES.int32,i.TYPES.sint32,i.TYPES.sfixed32,i.TYPES.uint32,i.TYPES.fixed32,i.TYPES.int64,i.TYPES.sint64,i.TYPES.sfixed64,i.TYPES.uint64,i.TYPES.fixed64,i.TYPES.bool,i.TYPES.string,i.TYPES.bytes],i.ID_MIN=1,i.ID_MAX=536870911,i.convertFieldsToCamelCase=!1,i.populateAccessors=!0,i.populateDefaults=!0,i.Util=function(){var e={};return e.IS_NODE=!("object"!=typeof process||process+""!="[object process]"||process.browser),e.XHR=function(){for(var e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],t=null,r=0;r<e.length;r++){try{t=e[r]()}catch(i){continue}break}if(!t)throw Error("XMLHttpRequest is not supported");return t},e.fetch=function(t,i){if(i&&"function"!=typeof i&&(i=null),e.IS_NODE){var n=r(14);if(i)n.readFile(t,function(e,t){i(e?null:""+t)});else try{return n.readFileSync(t)}catch(s){return null}}else{var o=e.XHR();if(o.open("GET",t,!!i),o.setRequestHeader("Accept","text/plain"),"function"==typeof o.overrideMimeType&&o.overrideMimeType("text/plain"),!i)return o.send(null),200==o.status||0==o.status&&"string"==typeof o.responseText?o.responseText:null;if(o.onreadystatechange=function(){4==o.readyState&&i(200==o.status||0==o.status&&"string"==typeof o.responseText?o.responseText:null)},4==o.readyState)return;o.send(null)}},e.toCamelCase=function(e){return e.replace(/_([a-zA-Z])/g,function(e,t){return t.toUpperCase()})},e}(),i.Lang={DELIM:/[\s\{\}=;:\[\],'"\(\)<>]/g,RULE:/^(?:required|optional|repeated|map)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0[xX][0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,ID:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,STRING_DQ:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,STRING_SQ:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},i.Reflect=function(t){function r(r){if("string"==typeof r&&(r=t.TYPES[r]),"undefined"==typeof r.defaultValue)throw Error("default value for type "+r.name+" is not supported");return r==t.TYPES.bytes?new e(0):r.defaultValue}function i(e,r){if(e&&"number"==typeof e.low&&"number"==typeof e.high&&"boolean"==typeof e.unsigned&&e.low===e.low&&e.high===e.high)return new t.Long(e.low,e.high,"undefined"==typeof r?e.unsigned:r);if("string"==typeof e)return t.Long.fromString(e,r||!1,10);if("number"==typeof e)return t.Long.fromNumber(e,r||!1);throw Error("not convertible to Long")}function n(e,r){var i=r.readVarint32(),s=7&i,o=i>>>3;switch(s){case t.WIRE_TYPES.VARINT:do i=r.readUint8();while(128===(128&i));break;case t.WIRE_TYPES.BITS64:r.offset+=8;break;case t.WIRE_TYPES.LDELIM:i=r.readVarint32(),r.offset+=i;break;case t.WIRE_TYPES.STARTGROUP:n(o,r);break;case t.WIRE_TYPES.ENDGROUP:if(o===e)return!1;throw Error("Illegal GROUPEND after unknown group: "+o+" ("+e+" expected)");case t.WIRE_TYPES.BITS32:r.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+e+": "+s)}return!0}var s={},o=function(e,t,r){this.builder=e,this.parent=t,this.name=r,this.className},a=o.prototype;a.fqn=function(){for(var e=this.name,t=this;;){if(t=t.parent,null==t)break;e=t.name+"."+e}return e},a.toString=function(e){return(e?this.className+" ":"")+this.fqn()},a.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},s.T=o;var l=function(e,t,r,i,n){o.call(this,e,t,r),this.className="Namespace",this.children=[],this.options=i||{},this.syntax=n||"proto2"},u=l.prototype=Object.create(o.prototype);u.getChildren=function(e){if(e=e||null,null==e)return this.children.slice();for(var t=[],r=0,i=this.children.length;r<i;++r)this.children[r]instanceof e&&t.push(this.children[r]);return t},u.addChild=function(e){var t;if(t=this.getChild(e.name))if(t instanceof p.Field&&t.name!==t.originalName&&null===this.getChild(t.originalName))t.name=t.originalName;else{if(!(e instanceof p.Field&&e.name!==e.originalName&&null===this.getChild(e.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+e.name);e.name=e.originalName}this.children.push(e)},u.getChild=function(e){for(var t="number"==typeof e?"id":"name",r=0,i=this.children.length;r<i;++r)if(this.children[r][t]===e)return this.children[r];return null},u.resolve=function(e,t){var r="string"==typeof e?e.split("."):e,i=this,n=0;if(""===r[n]){for(;null!==i.parent;)i=i.parent;n++}var o;do{do{if(!(i instanceof s.Namespace)){i=null;break}if(o=i.getChild(r[n]),!o||!(o instanceof s.T)||t&&!(o instanceof s.Namespace)){i=null;break}i=o,n++}while(n<r.length);if(null!=i)break;if(null!==this.parent)return this.parent.resolve(e,t)}while(null!=i);return i},u.qn=function(e){var t=[],r=e;do t.unshift(r.name),r=r.parent;while(null!==r);for(var i=1;i<=t.length;i++){var n=t.slice(t.length-i);if(e===this.resolve(n,e instanceof s.Namespace))return n.join(".")}return e.fqn()},u.build=function(){for(var e,t={},r=this.children,i=0,n=r.length;i<n;++i)e=r[i],e instanceof l&&(t[e.name]=e.build());return Object.defineProperty&&Object.defineProperty(t,"$options",{value:this.buildOpt()}),t},u.buildOpt=function(){for(var e={},t=Object.keys(this.options),r=0,i=t.length;r<i;++r){var n=t[r],s=this.options[t[r]];e[n]=s}return e},u.getOption=function(e){return"undefined"==typeof e?this.options:"undefined"!=typeof this.options[e]?this.options[e]:null},s.Namespace=l;var f=function(e,r,i,n){if(this.type=e,this.resolvedType=r,this.isMapKey=i,this.syntax=n,i&&t.MAP_KEY_TYPES.indexOf(e)<0)throw Error("Invalid map key type: "+e.name)},c=f.prototype;f.defaultFieldValue=r,c.verifyValue=function(r){function n(e,t){throw Error("Illegal value for "+s.toString(!0)+" of type "+s.type.name+": "+e+" ("+t+")")}var s=this;switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:return("number"!=typeof r||r===r&&r%1!==0)&&n(typeof r,"not an integer"),r>4294967295?0|r:r;case t.TYPES.uint32:case t.TYPES.fixed32:return("number"!=typeof r||r===r&&r%1!==0)&&n(typeof r,"not an integer"),r<0?r>>>0:r;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:if(t.Long)try{return i(r,!1)}catch(o){n(typeof r,o.message)}else n(typeof r,"requires Long.js");case t.TYPES.uint64:case t.TYPES.fixed64:if(t.Long)try{return i(r,!0)}catch(o){n(typeof r,o.message)}else n(typeof r,"requires Long.js");case t.TYPES.bool:return"boolean"!=typeof r&&n(typeof r,"not a boolean"),r;case t.TYPES["float"]:case t.TYPES["double"]:return"number"!=typeof r&&n(typeof r,"not a number"),r;case t.TYPES.string:return"string"==typeof r||r&&r instanceof String||n(typeof r,"not a string"),""+r;case t.TYPES.bytes:return e.isByteBuffer(r)?r:e.wrap(r,"base64");case t.TYPES["enum"]:var a=this.resolvedType.getChildren(t.Reflect.Enum.Value);for(u=0;u<a.length;u++){if(a[u].name==r)return a[u].id;if(a[u].id==r)return a[u].id}if("proto3"===this.syntax)return("number"!=typeof r||r===r&&r%1!==0)&&n(typeof r,"not an integer"),(r>4294967295||r<0)&&n(typeof r,"not in range for uint32"),r;n(r,"not a valid enum value");case t.TYPES.group:case t.TYPES.message:if(r&&"object"==typeof r||n(typeof r,"object expected"),r instanceof this.resolvedType.clazz)return r;if(r instanceof t.Builder.Message){var l={};for(var u in r)r.hasOwnProperty(u)&&(l[u]=r[u]);r=l}return new this.resolvedType.clazz(r)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+r+" (undefined type "+this.type+")")},c.calculateLength=function(r,i){if(null===i)return 0;var n;switch(this.type){case t.TYPES.int32:return i<0?e.calculateVarint64(i):e.calculateVarint32(i);case t.TYPES.uint32:return e.calculateVarint32(i);case t.TYPES.sint32:return e.calculateVarint32(e.zigZagEncode32(i));case t.TYPES.fixed32:case t.TYPES.sfixed32:case t.TYPES["float"]:return 4;case t.TYPES.int64:case t.TYPES.uint64:return e.calculateVarint64(i);case t.TYPES.sint64:return e.calculateVarint64(e.zigZagEncode64(i));case t.TYPES.fixed64:case t.TYPES.sfixed64:return 8;case t.TYPES.bool:return 1;case t.TYPES["enum"]:return e.calculateVarint32(i);case t.TYPES["double"]:return 8;case t.TYPES.string:return n=e.calculateUTF8Bytes(i),e.calculateVarint32(n)+n;case t.TYPES.bytes:if(i.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+i.remaining()+" bytes remaining");return e.calculateVarint32(i.remaining())+i.remaining();case t.TYPES.message:return n=this.resolvedType.calculate(i),e.calculateVarint32(n)+n;case t.TYPES.group:return n=this.resolvedType.calculate(i),n+e.calculateVarint32(r<<3|t.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+i+" (unknown type)")},c.encodeValue=function(r,i,n){if(null===i)return n;switch(this.type){case t.TYPES.int32:i<0?n.writeVarint64(i):n.writeVarint32(i);break;case t.TYPES.uint32:n.writeVarint32(i);break;case t.TYPES.sint32:n.writeVarint32ZigZag(i);break;case t.TYPES.fixed32:n.writeUint32(i);break;case t.TYPES.sfixed32:n.writeInt32(i);break;case t.TYPES.int64:case t.TYPES.uint64:n.writeVarint64(i);break;case t.TYPES.sint64:n.writeVarint64ZigZag(i);break;case t.TYPES.fixed64:n.writeUint64(i);break;case t.TYPES.sfixed64:n.writeInt64(i);break;case t.TYPES.bool:"string"==typeof i?n.writeVarint32("false"===i.toLowerCase()?0:!!i):n.writeVarint32(i?1:0);break;case t.TYPES["enum"]:n.writeVarint32(i);break;case t.TYPES["float"]:n.writeFloat32(i);break;case t.TYPES["double"]:n.writeFloat64(i);break;case t.TYPES.string:n.writeVString(i);break;case t.TYPES.bytes:if(i.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+i.remaining()+" bytes remaining");var s=i.offset;n.writeVarint32(i.remaining()),n.append(i),i.offset=s;break;case t.TYPES.message:var o=(new e).LE();this.resolvedType.encode(i,o),n.writeVarint32(o.offset),n.append(o.flip());break;case t.TYPES.group:this.resolvedType.encode(i,n),n.writeVarint32(r<<3|t.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+i+" (unknown type)")}return n},c.decode=function(e,r,i){if(r!=this.type.wireType)throw Error("Unexpected wire type for element");var n,s;switch(this.type){case t.TYPES.int32:return 0|e.readVarint32();case t.TYPES.uint32:return e.readVarint32()>>>0;case t.TYPES.sint32:return 0|e.readVarint32ZigZag();case t.TYPES.fixed32:return e.readUint32()>>>0;case t.TYPES.sfixed32:return 0|e.readInt32();case t.TYPES.int64:return e.readVarint64();case t.TYPES.uint64:return e.readVarint64().toUnsigned();case t.TYPES.sint64:return e.readVarint64ZigZag();case t.TYPES.fixed64:return e.readUint64();case t.TYPES.sfixed64:return e.readInt64();case t.TYPES.bool:return!!e.readVarint32();case t.TYPES["enum"]:return e.readVarint32();case t.TYPES["float"]:return e.readFloat();case t.TYPES["double"]:return e.readDouble();case t.TYPES.string:return e.readVString();case t.TYPES.bytes:if(s=e.readVarint32(),e.remaining()<s)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+s+" required but got only "+e.remaining());return n=e.clone(),n.limit=n.offset+s,e.offset+=s,n;case t.TYPES.message:return s=e.readVarint32(),this.resolvedType.decode(e,s);case t.TYPES.group:return this.resolvedType.decode(e,-1,i)}throw Error("[INTERNAL] Illegal decode type")},c.valueFromString=function(r){if(!this.isMapKey)throw Error("valueFromString() called on non-map-key element");switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return this.verifyValue(parseInt(r));case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return this.verifyValue(r);case t.TYPES.bool:return"true"===r;case t.TYPES.string:return this.verifyValue(r);case t.TYPES.bytes:return e.fromBinary(r)}},c.valueToString=function(e){if(!this.isMapKey)throw Error("valueToString() called on non-map-key element");return this.type===t.TYPES.bytes?e.toString("binary"):e.toString()},s.Element=f;var p=function(e,t,r,i,n,s){l.call(this,e,t,r,i,s),this.className="Message",this.extensions=void 0,this.clazz=null,this.isGroup=!!n,this._fields=null,this._fieldsById=null,this._fieldsByName=null},h=p.prototype=Object.create(l.prototype);h.build=function(r){if(this.clazz&&!r)return this.clazz;var i=function(t,r){function i(r,n,s,o){if(null===r||"object"!=typeof r){if(o&&o instanceof t.Reflect.Enum){var a=t.Reflect.Enum.getName(o.object,r);if(null!==a)return a}return r}if(e.isByteBuffer(r))return n?r.toBase64():r.toBuffer();if(t.Long.isLong(r))return s?r.toString():t.Long.fromValue(r);var l;if(Array.isArray(r))return l=[],r.forEach(function(e,t){l[t]=i(e,n,s,o)}),l;if(l={},r instanceof t.Map){for(var u=r.entries(),f=u.next();!f.done;f=u.next())l[r.keyElem.valueToString(f.value[0])]=i(f.value[1],n,s,r.valueElem.resolvedType);return l}var c=r.$type,p=void 0;for(var h in r)r.hasOwnProperty(h)&&(c&&(p=c.getChild(h))?l[h]=i(r[h],n,s,p.resolvedType):l[h]=i(r[h],n,s));return l}var n=r.getChildren(t.Reflect.Message.Field),s=r.getChildren(t.Reflect.Message.OneOf),o=function(i,a){t.Builder.Message.call(this);for(var l=0,u=s.length;l<u;++l)this[s[l].name]=null;for(l=0,u=n.length;l<u;++l){var f=n[l];this[f.name]=f.repeated?[]:f.map?new t.Map(f):null,!f.required&&"proto3"!==r.syntax||null===f.defaultValue||(this[f.name]=f.defaultValue)}if(arguments.length>0){var c;if(1!==arguments.length||null===i||"object"!=typeof i||!("function"!=typeof i.encode||i instanceof o)||Array.isArray(i)||i instanceof t.Map||e.isByteBuffer(i)||i instanceof ArrayBuffer||t.Long&&i instanceof t.Long)for(l=0,u=arguments.length;l<u;++l)"undefined"!=typeof(c=arguments[l])&&this.$set(n[l].name,c);else this.$set(i)}},a=o.prototype=Object.create(t.Builder.Message.prototype);a.add=function(e,i,n){var s=r._fieldsByName[e];if(!n){if(!s)throw Error(this+"#"+e+" is undefined");if(!(s instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+s.toString(!0));if(!s.repeated)throw Error(this+"#"+e+" is not a repeated field");i=s.verifyValue(i,!0)}return null===this[e]&&(this[e]=[]),this[e].push(i),this},a.$add=a.add,a.set=function(e,i,n){if(e&&"object"==typeof e){n=i;for(var s in e)e.hasOwnProperty(s)&&"undefined"!=typeof(i=e[s])&&this.$set(s,i,n);return this}var o=r._fieldsByName[e];if(n)this[e]=i;else{if(!o)throw Error(this+"#"+e+" is not a field: undefined");if(!(o instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+o.toString(!0));this[o.name]=i=o.verifyValue(i)}if(o&&o.oneof){var a=this[o.oneof.name];null!==i?(null!==a&&a!==o.name&&(this[a]=null),this[o.oneof.name]=o.name):a===e&&(this[o.oneof.name]=null)}return this},a.$set=a.set,a.get=function(e,i){if(i)return this[e];var n=r._fieldsByName[e];if(!(n&&n instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: undefined");if(!(n instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+n.toString(!0));return this[n.name]},a.$get=a.get;for(var l=0;l<n.length;l++){var u=n[l];u instanceof t.Reflect.Message.ExtensionField||r.builder.options.populateAccessors&&function(e){var t=e.originalName.replace(/(_[a-zA-Z])/g,function(e){return e.toUpperCase().replace("_","")});t=t.substring(0,1).toUpperCase()+t.substring(1);var i=e.originalName.replace(/([A-Z])/g,function(e){return"_"+e}),n=function(t,r){return this[e.name]=r?t:e.verifyValue(t),this},s=function(){return this[e.name]};null===r.getChild("set"+t)&&(a["set"+t]=n),null===r.getChild("set_"+i)&&(a["set_"+i]=n),null===r.getChild("get"+t)&&(a["get"+t]=s),null===r.getChild("get_"+i)&&(a["get_"+i]=s)}(u)}a.encode=function(t,i){"boolean"==typeof t&&(i=t,t=void 0);var n=!1;t||(t=new e,n=!0);var s=t.littleEndian;try{return r.encode(this,t.LE(),i),(n?t.flip():t).LE(s)}catch(o){throw t.LE(s),o}},o.encode=function(e,t,r){return new o(e).encode(t,r)},a.calculate=function(){return r.calculate(this)},a.encodeDelimited=function(t,i){var n=!1;t||(t=new e,n=!0);var s=(new e).LE();return r.encode(this,s,i).flip(),t.writeVarint32(s.remaining()),t.append(s),n?t.flip():t},a.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toArrayBuffer()),e}},a.toArrayBuffer=a.encodeAB,a.encodeNB=function(){try{return this.encode().toBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBuffer()),e}},a.toBuffer=a.encodeNB,a.encode64=function(){try{return this.encode().toBase64()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBase64()),e}},a.toBase64=a.encode64,a.encodeHex=function(){try{return this.encode().toHex()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toHex()),e}},a.toHex=a.encodeHex,a.toRaw=function(e,t){return i(this,!!e,!!t,this.$type)},a.encodeJSON=function(){return JSON.stringify(i(this,!0,!0,this.$type))},o.decode=function(t,i,n){"string"==typeof i&&(n=i,i=-1),"string"==typeof t&&(t=e.wrap(t,n?n:"base64")),t=e.isByteBuffer(t)?t:e.wrap(t);var s=t.littleEndian;try{var o=r.decode(t.LE());return t.LE(s),o}catch(a){throw t.LE(s),a}},o.decodeDelimited=function(t,i){if("string"==typeof t&&(t=e.wrap(t,i?i:"base64")),t=e.isByteBuffer(t)?t:e.wrap(t),t.remaining()<1)return null;var n=t.offset,s=t.readVarint32();if(t.remaining()<s)return t.offset=n,null;try{var o=r.decode(t.slice(t.offset,t.offset+s).LE());return t.offset+=s,o}catch(a){throw t.offset+=s,a}},o.decode64=function(e){return o.decode(e,"base64")},o.decodeHex=function(e){return o.decode(e,"hex")},o.decodeJSON=function(e){return new o(JSON.parse(e))},a.toString=function(){return r.toString()};return Object.defineProperty&&(Object.defineProperty(o,"$options",{value:r.buildOpt()}),Object.defineProperty(a,"$options",{value:o.$options}),Object.defineProperty(o,"$type",{value:r}),Object.defineProperty(a,"$type",{value:r})),o}(t,this);this._fields=[],this._fieldsById={},this._fieldsByName={};for(var n,s=0,o=this.children.length;s<o;s++)if(n=this.children[s],n instanceof m||n instanceof p||n instanceof b){if(i.hasOwnProperty(n.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+n.toString(!0)+" cannot override static property '"+n.name+"'");i[n.name]=n.build()}else if(n instanceof p.Field)n.build(),this._fields.push(n),this._fieldsById[n.id]=n,this._fieldsByName[n.name]=n;else if(!(n instanceof p.OneOf||n instanceof S))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[s].toString(!0));return this.clazz=i},h.encode=function(e,t,r){for(var i,n,s=null,o=0,a=this._fields.length;o<a;++o)i=this._fields[o],n=e[i.name],i.required&&null===n?null===s&&(s=i):i.encode(r?n:i.verifyValue(n),t,e);if(null!==s){var l=Error("Missing at least one required field for "+this.toString(!0)+": "+s);throw l.encoded=t,l}return t},h.calculate=function(e){for(var t,r,i=0,n=0,s=this._fields.length;n<s;++n){if(t=this._fields[n],r=e[t.name],t.required&&null===r)throw Error("Missing at least one required field for "+this.toString(!0)+": "+t);i+=t.calculate(r,e)}return i},h.decode=function(e,r,i){r="number"==typeof r?r:-1;for(var s,o,a,l,u=e.offset,f=new this.clazz;e.offset<u+r||r===-1&&e.remaining()>0;){if(s=e.readVarint32(),o=7&s,a=s>>>3,o===t.WIRE_TYPES.ENDGROUP){if(a!==i)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+a+" ("+(i?i+" expected":"not a group")+")");break}if(l=this._fieldsById[a]){if(l.repeated&&!l.options.packed)f[l.name].push(l.decode(o,e));else if(l.map){var c=l.decode(o,e);f[l.name].set(c[0],c[1])}else if(f[l.name]=l.decode(o,e),l.oneof){var p=f[l.oneof.name];null!==p&&p!==l.name&&(f[p]=null),f[l.oneof.name]=l.name}}else switch(o){case t.WIRE_TYPES.VARINT:e.readVarint32();break;case t.WIRE_TYPES.BITS32:e.offset+=4;break;case t.WIRE_TYPES.BITS64:e.offset+=8;break;case t.WIRE_TYPES.LDELIM:var h=e.readVarint32();e.offset+=h;break;case t.WIRE_TYPES.STARTGROUP:for(;n(a,e););break;default:throw Error("Illegal wire type for unknown field "+a+" in "+this.toString(!0)+"#decode: "+o)}}for(var d=0,y=this._fields.length;d<y;++d)if(l=this._fields[d],null===f[l.name])if("proto3"===this.syntax)f[l.name]=l.defaultValue;else{if(l.required){var E=Error("Missing at least one required field for "+this.toString(!0)+": "+l.name);throw E.decoded=f,E}t.populateDefaults&&null!==l.defaultValue&&(f[l.name]=l.defaultValue)}return f},s.Message=p;var d=function(e,r,i,n,s,a,l,u,f,c){o.call(this,e,r,a),this.className="Message.Field",this.required="required"===i,this.repeated="repeated"===i,this.map="map"===i,this.keyType=n||null,this.type=s,this.resolvedType=null,this.id=l,this.options=u||{},this.defaultValue=null,this.oneof=f||null,this.syntax=c||"proto2",this.originalName=this.name,this.element=null,this.keyElement=null,!this.builder.options.convertFieldsToCamelCase||this instanceof p.ExtensionField||(this.name=t.Util.toCamelCase(this.name))},y=d.prototype=Object.create(o.prototype);y.build=function(){this.element=new f(this.type,this.resolvedType,(!1),this.syntax),this.map&&(this.keyElement=new f(this.keyType,(void 0),(!0),this.syntax)),"proto3"!==this.syntax||this.repeated||this.map?"undefined"!=typeof this.options["default"]&&(this.defaultValue=this.verifyValue(this.options["default"])):this.defaultValue=f.defaultFieldValue(this.type)},y.verifyValue=function(e,r){function i(e,t){throw Error("Illegal value for "+n.toString(!0)+" of type "+n.type.name+": "+e+" ("+t+")")}r=r||!1;var n=this;if(null===e)return this.required&&i(typeof e,"required"),"proto3"===this.syntax&&this.type!==t.TYPES.message&&i(typeof e,"proto3 field without field presence cannot be null"),null;var s;if(this.repeated&&!r){Array.isArray(e)||(e=[e]);var o=[];for(s=0;s<e.length;s++)o.push(this.element.verifyValue(e[s]));return o}return this.map&&!r?e instanceof t.Map?e:(e instanceof Object||i(typeof e,"expected ProtoBuf.Map or raw object for map field"),new t.Map(this,e)):(!this.repeated&&Array.isArray(e)&&i(typeof e,"no array expected"),this.element.verifyValue(e))},y.hasWirePresence=function(e,r){if("proto3"!==this.syntax)return null!==e;if(this.oneof&&r[this.oneof.name]===this.name)return!0;switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return 0!==e;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return 0!==e.low||0!==e.high;case t.TYPES.bool:return e;case t.TYPES["float"]:case t.TYPES["double"]:return 0!==e;case t.TYPES.string:return e.length>0;case t.TYPES.bytes:return e.remaining()>0;case t.TYPES["enum"]:return 0!==e;case t.TYPES.message:return null!==e;default:return!0}},y.encode=function(r,i,n){if(null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===r||this.repeated&&0==r.length)return i;try{if(this.repeated){var s;if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){i.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),i.ensureCapacity(i.offset+=1);var o=i.offset;for(s=0;s<r.length;s++)this.element.encodeValue(this.id,r[s],i);var a=i.offset-o,l=e.calculateVarint32(a);if(l>1){var u=i.slice(o,i.offset);o+=l-1,i.offset=o,i.append(u)}i.writeVarint32(a,o-l)}else for(s=0;s<r.length;s++)i.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,r[s],i)}else this.map?r.forEach(function(r,n,s){var o=e.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,n)+e.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,r);i.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),i.writeVarint32(o),i.writeVarint32(8|this.keyType.wireType),this.keyElement.encodeValue(1,n,i),i.writeVarint32(16|this.type.wireType),this.element.encodeValue(2,r,i)},this):this.hasWirePresence(r,n)&&(i.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,r,i))}catch(f){throw Error("Illegal value for "+this.toString(!0)+": "+r+" ("+f+")")}return i},y.calculate=function(r,i){if(r=this.verifyValue(r),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===r||this.repeated&&0==r.length)return 0;var n=0;try{if(this.repeated){var s,o;if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(n+=e.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),o=0,s=0;s<r.length;s++)o+=this.element.calculateLength(this.id,r[s]);n+=e.calculateVarint32(o),n+=o}else for(s=0;s<r.length;s++)n+=e.calculateVarint32(this.id<<3|this.type.wireType),n+=this.element.calculateLength(this.id,r[s])}else this.map?r.forEach(function(r,i,s){var o=e.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,i)+e.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,r);n+=e.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),n+=e.calculateVarint32(o),n+=o},this):this.hasWirePresence(r,i)&&(n+=e.calculateVarint32(this.id<<3|this.type.wireType),n+=this.element.calculateLength(this.id,r))}catch(a){throw Error("Illegal value for "+this.toString(!0)+": "+r+" ("+a+")")}return n},y.decode=function(e,r,i){var n,s,o=!this.map&&e==this.type.wireType||!i&&this.repeated&&this.options.packed&&e==t.WIRE_TYPES.LDELIM||this.map&&e==t.WIRE_TYPES.LDELIM;if(!o)throw Error("Illegal wire type for field "+this.toString(!0)+": "+e+" ("+this.type.wireType+" expected)");if(e==t.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0&&!i){s=r.readVarint32(),s=r.offset+s;for(var a=[];r.offset<s;)a.push(this.decode(this.type.wireType,r,!0));return a}if(this.map){var l=f.defaultFieldValue(this.keyType);if(n=f.defaultFieldValue(this.type),s=r.readVarint32(),r.remaining()<s)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+s+" required but got only "+r.remaining());var u=r.clone();for(u.limit=u.offset+s,r.offset+=s;u.remaining()>0;){var c=u.readVarint32();e=7&c;var p=c>>>3;if(1===p)l=this.keyElement.decode(u,e,p);else{if(2!==p)throw Error("Unexpected tag in map field key/value submessage");n=this.element.decode(u,e,p)}}return[l,n]}return this.element.decode(r,e,this.id)},s.Message.Field=d;var E=function(e,t,r,i,n,s,o){d.call(this,e,t,r,null,i,n,s,o),this.extension};E.prototype=Object.create(d.prototype),s.Message.ExtensionField=E;var g=function(e,t,r){o.call(this,e,t,r),this.fields=[]};s.Message.OneOf=g;var m=function(e,t,r,i,n){l.call(this,e,t,r,i,n),this.className="Enum",this.object=null};m.getName=function(e,t){for(var r,i=Object.keys(e),n=0;n<i.length;++n)if(e[r=i[n]]===t)return r;return null};var v=m.prototype=Object.create(l.prototype);v.build=function(e){if(this.object&&!e)return this.object;for(var r=new t.Builder.Enum,i=this.getChildren(m.Value),n=0,s=i.length;n<s;++n)r[i[n].name]=i[n].id;return Object.defineProperty&&Object.defineProperty(r,"$options",{value:this.buildOpt(),enumerable:!1}),this.object=r},s.Enum=m;var T=function(e,t,r,i){o.call(this,e,t,r),this.className="Enum.Value",this.id=i};T.prototype=Object.create(o.prototype),s.Enum.Value=T;var S=function(e,t,r,i){o.call(this,e,t,r),this.field=i};S.prototype=Object.create(o.prototype),s.Extension=S;var b=function(e,t,r,i){l.call(this,e,t,r,i),this.className="Service",this.clazz=null},P=b.prototype=Object.create(l.prototype);P.build=function(r){return this.clazz&&!r?this.clazz:this.clazz=function(t,r){for(var i=function(e){t.Builder.Service.call(this),this.rpcImpl=e||function(e,t,r){setTimeout(r.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},n=i.prototype=Object.create(t.Builder.Service.prototype),s=r.getChildren(t.Reflect.Service.RPCMethod),o=0;o<s.length;o++)!function(t){n[t.name]=function(i,n){try{try{i=t.resolvedRequestType.clazz.decode(e.wrap(i))}catch(s){if(!(s instanceof TypeError))throw s}if(null===i||"object"!=typeof i)throw Error("Illegal arguments");i instanceof t.resolvedRequestType.clazz||(i=new t.resolvedRequestType.clazz(i)),this.rpcImpl(t.fqn(),i,function(e,i){if(e)return void n(e);null===i&&(i="");try{i=t.resolvedResponseType.clazz.decode(i)}catch(s){}return i&&i instanceof t.resolvedResponseType.clazz?void n(null,i):void n(Error("Illegal response type received in service method "+r.name+"#"+t.name))})}catch(s){setTimeout(n.bind(this,s),0)}},i[t.name]=function(e,r,n){new i(e)[t.name](r,n)},Object.defineProperty&&(Object.defineProperty(i[t.name],"$options",{value:t.buildOpt()}),Object.defineProperty(n[t.name],"$options",{value:i[t.name].$options}))}(s[o]);return Object.defineProperty&&(Object.defineProperty(i,"$options",{value:r.buildOpt()}),Object.defineProperty(n,"$options",{value:i.$options}),Object.defineProperty(i,"$type",{value:r}),Object.defineProperty(n,"$type",{value:r})),i}(t,this)},s.Service=b;var w=function(e,t,r,i){o.call(this,e,t,r),this.className="Service.Method",this.options=i||{}},Y=w.prototype=Object.create(o.prototype);Y.buildOpt=u.buildOpt,s.Service.Method=w;var I=function(e,t,r,i,n,s,o,a){w.call(this,e,t,r,a),this.className="Service.RPCMethod",this.requestName=i,this.responseName=n,this.requestStream=s,this.responseStream=o,this.resolvedRequestType=null,this.resolvedResponseType=null};return I.prototype=Object.create(w.prototype),s.Service.RPCMethod=I,s}(i),i.Builder=function(e,t,i){function n(e){e.messages&&e.messages.forEach(function(t){t.syntax=e.syntax,n(t)}),e.enums&&e.enums.forEach(function(t){t.syntax=e.syntax})}var s=function(e){this.ns=new i.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=e||{}},o=s.prototype;return s.isMessage=function(e){return"string"==typeof e.name&&("undefined"==typeof e.values&&"undefined"==typeof e.rpc)},s.isMessageField=function(e){return"string"==typeof e.rule&&"string"==typeof e.name&&"string"==typeof e.type&&"undefined"!=typeof e.id;
},s.isEnum=function(e){return"string"==typeof e.name&&!("undefined"==typeof e.values||!Array.isArray(e.values)||0===e.values.length)},s.isService=function(e){return!("string"!=typeof e.name||"object"!=typeof e.rpc||!e.rpc)},s.isExtend=function(e){return"string"==typeof e.ref},o.reset=function(){return this.ptr=this.ns,this},o.define=function(e){if("string"!=typeof e||!t.TYPEREF.test(e))throw Error("illegal namespace: "+e);return e.split(".").forEach(function(e){var t=this.ptr.getChild(e);null===t&&this.ptr.addChild(t=new i.Namespace(this,this.ptr,e)),this.ptr=t},this),this},o.create=function(t){if(!t)return this;if(Array.isArray(t)){if(0===t.length)return this;t=t.slice()}else t=[t];for(var r=[t];r.length>0;){if(t=r.pop(),!Array.isArray(t))throw Error("not a valid namespace: "+JSON.stringify(t));for(;t.length>0;){var n=t.shift();if(s.isMessage(n)){var o=new i.Message(this,this.ptr,n.name,n.options,n.isGroup,n.syntax),a={};n.oneofs&&Object.keys(n.oneofs).forEach(function(e){o.addChild(a[e]=new i.Message.OneOf(this,o,e))},this),n.fields&&n.fields.forEach(function(e){if(null!==o.getChild(0|e.id))throw Error("duplicate or invalid field id in "+o.name+": "+e.id);if(e.options&&"object"!=typeof e.options)throw Error("illegal field options in "+o.name+"#"+e.name);var t=null;if("string"==typeof e.oneof&&!(t=a[e.oneof]))throw Error("illegal oneof in "+o.name+"#"+e.name+": "+e.oneof);e=new i.Message.Field(this,o,e.rule,e.keytype,e.type,e.name,e.id,e.options,t,n.syntax),t&&t.fields.push(e),o.addChild(e)},this);var l=[];if(n.enums&&n.enums.forEach(function(e){l.push(e)}),n.messages&&n.messages.forEach(function(e){l.push(e)}),n.services&&n.services.forEach(function(e){l.push(e)}),n.extensions&&("number"==typeof n.extensions[0]?o.extensions=[n.extensions]:o.extensions=n.extensions),this.ptr.addChild(o),l.length>0){r.push(t),t=l,l=null,this.ptr=o,o=null;continue}l=null}else if(s.isEnum(n))o=new i.Enum(this,this.ptr,n.name,n.options,n.syntax),n.values.forEach(function(e){o.addChild(new i.Enum.Value(this,o,e.name,e.id))},this),this.ptr.addChild(o);else if(s.isService(n))o=new i.Service(this,this.ptr,n.name,n.options),Object.keys(n.rpc).forEach(function(e){var t=n.rpc[e];o.addChild(new i.Service.RPCMethod(this,o,e,t.request,t.response,(!!t.request_stream),(!!t.response_stream),t.options))},this),this.ptr.addChild(o);else{if(!s.isExtend(n))throw Error("not a valid definition: "+JSON.stringify(n));if(o=this.ptr.resolve(n.ref,!0))n.fields.forEach(function(t){if(null!==o.getChild(0|t.id))throw Error("duplicate extended field id in "+o.name+": "+t.id);if(o.extensions){var r=!1;if(o.extensions.forEach(function(e){t.id>=e[0]&&t.id<=e[1]&&(r=!0)}),!r)throw Error("illegal extended field id in "+o.name+": "+t.id+" (not within valid ranges)")}var n=t.name;this.options.convertFieldsToCamelCase&&(n=e.Util.toCamelCase(n));var s=new i.Message.ExtensionField(this,o,t.rule,t.type,this.ptr.fqn()+"."+n,t.id,t.options),a=new i.Extension(this,this.ptr,t.name,s);s.extension=a,this.ptr.addChild(a),o.addChild(s)},this);else if(!/\.?google\.protobuf\./.test(n.ref))throw Error("extended message "+n.ref+" is not defined")}n=null,o=null}t=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},o["import"]=function(t,i){var s="/";if("string"==typeof i){if(e.Util.IS_NODE&&(i=r(15).resolve(i)),this.files[i]===!0)return this.reset();this.files[i]=!0}else if("object"==typeof i){var o=i.root;e.Util.IS_NODE&&(o=r(15).resolve(o)),(o.indexOf("\\")>=0||i.file.indexOf("\\")>=0)&&(s="\\");var a=o+s+i.file;if(this.files[a]===!0)return this.reset();this.files[a]=!0}if(t.imports&&t.imports.length>0){var l,u=!1;"object"==typeof i?(this.importRoot=i.root,u=!0,l=this.importRoot,i=i.file,(l.indexOf("\\")>=0||i.indexOf("\\")>=0)&&(s="\\")):"string"==typeof i?this.importRoot?l=this.importRoot:i.indexOf("/")>=0?(l=i.replace(/\/[^\/]*$/,""),""===l&&(l="/")):i.indexOf("\\")>=0?(l=i.replace(/\\[^\\]*$/,""),s="\\"):l=".":l=null;for(var f=0;f<t.imports.length;f++)if("string"==typeof t.imports[f]){if(!l)throw Error("cannot determine import root");var c=t.imports[f];if("google/protobuf/descriptor.proto"===c)continue;if(c=l+s+c,this.files[c]===!0)continue;/\.proto$/i.test(c)&&!e.DotProto&&(c=c.replace(/\.proto$/,".json"));var p=e.Util.fetch(c);if(null===p)throw Error("failed to import '"+c+"' in '"+i+"': file not found");/\.json$/i.test(c)?this["import"](JSON.parse(p+""),c):this["import"](e.DotProto.Parser.parse(p),c)}else i?/\.(\w+)$/.test(i)?this["import"](t.imports[f],i.replace(/^(.+)\.(\w+)$/,function(e,t,r){return t+"_import"+f+"."+r})):this["import"](t.imports[f],i+"_import"+f):this["import"](t.imports[f]);u&&(this.importRoot=null)}t["package"]&&this.define(t["package"]),t.syntax&&n(t);var h=this.ptr;return t.options&&Object.keys(t.options).forEach(function(e){h.options[e]=t.options[e]}),t.messages&&(this.create(t.messages),this.ptr=h),t.enums&&(this.create(t.enums),this.ptr=h),t.services&&(this.create(t.services),this.ptr=h),t["extends"]&&this.create(t["extends"]),this.reset()},o.resolveAll=function(){var r;if(null==this.ptr||"object"==typeof this.ptr.type)return this;if(this.ptr instanceof i.Namespace)this.ptr.children.forEach(function(e){this.ptr=e,this.resolveAll()},this);else if(this.ptr instanceof i.Message.Field){if(t.TYPE.test(this.ptr.type))this.ptr.type=e.TYPES[this.ptr.type];else{if(!t.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(r=(this.ptr instanceof i.Message.ExtensionField?this.ptr.extension.parent:this.ptr.parent).resolve(this.ptr.type,!0),!r)throw Error("unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=r,r instanceof i.Enum){if(this.ptr.type=e.TYPES["enum"],"proto3"===this.ptr.syntax&&"proto3"!==r.syntax)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(r instanceof i.Message))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=r.isGroup?e.TYPES.group:e.TYPES.message}}if(this.ptr.map){if(!t.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in "+this.ptr.toString(!0)+": "+this.ptr.keyType);this.ptr.keyType=e.TYPES[this.ptr.keyType]}}else if(this.ptr instanceof e.Reflect.Service.Method){if(!(this.ptr instanceof e.Reflect.Service.RPCMethod))throw Error("illegal service type in "+this.ptr.toString(!0));if(r=this.ptr.parent.resolve(this.ptr.requestName,!0),!(r&&r instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=r,r=this.ptr.parent.resolve(this.ptr.responseName,!0),!(r&&r instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=r}else if(!(this.ptr instanceof e.Reflect.Message.OneOf||this.ptr instanceof e.Reflect.Extension||this.ptr instanceof e.Reflect.Enum.Value))throw Error("illegal object in namespace: "+typeof this.ptr+": "+this.ptr);return this.reset()},o.build=function(e){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null===this.result&&(this.result=this.ns.build()),!e)return this.result;for(var t="string"==typeof e?e.split("."):e,r=this.result,i=0;i<t.length;i++){if(!r[t[i]]){r=null;break}r=r[t[i]]}return r},o.lookup=function(e,t){return e?this.ns.resolve(e,t):this.ns},o.toString=function(){return"Builder"},s.Message=function(){},s.Enum=function(){},s.Service=function(){},s}(i,i.Lang,i.Reflect),i.Map=function(e,t){function r(e){var t=0;return{next:function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}}var i=function(e,r){if(!e.map)throw Error("field is not a map");if(this.field=e,this.keyElem=new t.Element(e.keyType,null,(!0),e.syntax),this.valueElem=new t.Element(e.type,e.resolvedType,(!1),e.syntax),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),r)for(var i=Object.keys(r),n=0;n<i.length;n++){var s=this.keyElem.valueFromString(i[n]),o=this.valueElem.verifyValue(r[i[n]]);this.map[this.keyElem.valueToString(s)]={key:s,value:o}}},n=i.prototype;return n.clear=function(){this.map={}},n["delete"]=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e)),r=t in this.map;return delete this.map[t],r},n.entries=function(){for(var e,t=[],i=Object.keys(this.map),n=0;n<i.length;n++)t.push([(e=this.map[i[n]]).key,e.value]);return r(t)},n.keys=function(){for(var e=[],t=Object.keys(this.map),i=0;i<t.length;i++)e.push(this.map[t[i]].key);return r(e)},n.values=function(){for(var e=[],t=Object.keys(this.map),i=0;i<t.length;i++)e.push(this.map[t[i]].value);return r(e)},n.forEach=function(e,t){for(var r,i=Object.keys(this.map),n=0;n<i.length;n++)e.call(t,(r=this.map[i[n]]).value,r.key,this)},n.set=function(e,t){var r=this.keyElem.verifyValue(e),i=this.valueElem.verifyValue(t);return this.map[this.keyElem.valueToString(r)]={key:r,value:i},this},n.get=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e));if(t in this.map)return this.map[t].value},n.has=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e));return t in this.map},i}(i,i.Reflect),i.newBuilder=function(e){return e=e||{},"undefined"==typeof e.convertFieldsToCamelCase&&(e.convertFieldsToCamelCase=i.convertFieldsToCamelCase),"undefined"==typeof e.populateAccessors&&(e.populateAccessors=i.populateAccessors),new i.Builder(e)},i.loadJson=function(e,t,r){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(r=t,t=null),t&&"object"==typeof t||(t=i.newBuilder()),"string"==typeof e&&(e=JSON.parse(e)),t["import"](e,r),t.resolveAll(),t},i.loadJsonFile=function(e,t,r){if(t&&"object"==typeof t?(r=t,t=null):t&&"function"==typeof t||(t=null),t)return i.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,function(n){if(null===n)return void t(Error("Failed to fetch file"));try{t(null,i.loadJson(JSON.parse(n),r,e))}catch(s){t(s)}});var n=i.Util.fetch("object"==typeof e?e.root+"/"+e.file:e);return null===n?null:i.loadJson(JSON.parse(n),r,e)},i})}).call(t,r(11)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t){e.exports=require("bytebuffer")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("path")},,function(e,t){e.exports=require("es6-promise")},function(e,t){e.exports=require("axios")}])});